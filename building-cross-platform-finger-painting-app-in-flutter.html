
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow" />

  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://ptyagicodecamp.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://ptyagicodecamp.github.io/theme/pygments/monokai.min.css">
  <link rel="stylesheet" type="text/css" href="https://ptyagicodecamp.github.io/theme/font-awesome/css/font-awesome.min.css">

    <link href="https://ptyagicodecamp.github.io/static/custom.css" rel="stylesheet">

    <link href="https://ptyagicodecamp.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="techLog Atom">


    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-133714063-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->
    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333333">

<meta name="author" content="ptyagi" />
<meta name="description" content="This code recipe focuses on building a cross-platform finger painting app using Flutter." />
<meta name="keywords" content="Canvas, Painting, Cross-platform, Flutter, Code-recipes, Android, Android Studio, iOS, development">

<meta property="og:site_name" content="techLog"/>
<meta property="og:title" content="Building Cross-Platform Finger Painting App in Flutter"/>
<meta property="og:description" content="This code recipe focuses on building a cross-platform finger painting app using Flutter."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://ptyagicodecamp.github.io/building-cross-platform-finger-painting-app-in-flutter.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2020-03-31 00:00:00-04:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://ptyagicodecamp.github.io/author/ptyagi.html">
<meta property="article:section" content="Flutter"/>
<meta property="article:tag" content="Canvas"/>
<meta property="article:tag" content="Painting"/>
<meta property="article:tag" content="Cross-platform"/>
<meta property="article:tag" content="Flutter"/>
<meta property="article:tag" content="Code-recipes"/>
<meta property="article:tag" content="Android"/>
<meta property="article:tag" content="Android Studio"/>
<meta property="article:tag" content="iOS"/>
<meta property="article:tag" content="development"/>
<meta property="og:image" content="https://ptyagicodecamp.github.io/images/profile.jpg">

  <title>techLog &ndash; Building Cross-Platform Finger Painting App in Flutter</title>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6359982310050489",
      enable_page_level_ads: true
    });
  </script>
</head>
<body>
  <aside>
    <div>
      <a href="https://ptyagicodecamp.github.io">
        <img src="https://ptyagicodecamp.github.io/images/profile.jpg" alt="techLog" title="techLog">
      </a>
      <h1><a href="https://ptyagicodecamp.github.io">techLog</a></h1>

<p>Explore | Android | Flutter | Software Engineering</p>
      <nav>
        <ul class="list">

          <li><a href="https://www.paypal.me/pritya" target="_blank">Support</a></li>
          <li><a href="https://www.codementor.io/ptyagicodecamp" target="_blank">Codementor</a></li>
        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/priyankatyagi" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/ptyagicodecamp" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-medium" href="https://medium.com/@ptyagicodecamp" target="_blank"><i class="fa fa-medium"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/ptyagi13" target="_blank"><i class="fa fa-twitter"></i></a></li>
        <li><a class="sc-youtube" href="https://www.youtube.com/channel/UCO3_dbHasEnA2dr_U0EhMAA?view_as=subscriber" target="_blank"><i class="fa fa-youtube"></i></a></li>
        <li><a class="sc-codementor" href="https://www.codementor.io/ptyagicodecamp" target="_blank"><i class="fa fa-codementor"></i></a></li>
      </ul>
    </div>

      <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      <ins class="adsbygoogle ads-aside"
           data-ad-client="ca-pub-6359982310050489"
           data-ad-slot="8977779775"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>

  </aside>
  <main>

    <nav>
      <a href="https://ptyagicodecamp.github.io">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="https://ptyagicodecamp.github.io/feeds/all.atom.xml">    Atom
</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="building-cross-platform-finger-painting-app-in-flutter">Building Cross-Platform Finger Painting App in Flutter</h1>
    <p>
          Posted on March 31, 2020 in <a href="https://ptyagicodecamp.github.io/category/flutter.html">Flutter</a>


    </p>
  </header>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle ads-responsive"
         data-ad-client="ca-pub-6359982310050489"
         data-ad-slot="6546879945"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

  <div>
    <p><img alt="Canvas-Painting" src="https://ptyagicodecamp.github.io/canvas_header.jpg"></p>
<p><strong>Target Audience:</strong> Beginner</p>
<p><strong>Recipe:</strong> In this code recipe, you'll use canvas painting to build a Finger Painting App in Flutter.</p>
<p><strong>Focus Widget(s):</strong> <a href="https://api.flutter.dev/flutter/widgets/GestureDetector-class.html">GestureDetector</a>, <a href="https://api.flutter.dev/flutter/widgets/CustomPaint-class.html">CustomPaint</a></p>
<p><strong>Goal:</strong> We'll implement the following items in this Finger Painting Flutter App :</p>
<ul>
<li><strong>Drawing / Painting Area:</strong> This is the main area of the screen where an image can be displayed to color or draw more details to it.</li>
</ul>
<p><img alt="Canvas-Painting" src="https://ptyagicodecamp.github.io/paint_canvas_2.jpg"></p>
<ul>
<li><strong>Action Items:</strong> A Floating Action Button (FAB) menu to store all the menu items to make color, stroke, and opacity selections.</li>
</ul>
<p><img alt="Canvas-Painting" src="https://ptyagicodecamp.github.io/paint_canvas_3.jpg"></p>
<hr>
<p><strong>Flutter Cookbook:</strong></p>
<p>This code recipe is added to <a href="https://ptyagicodecamp.github.io/flutter-live-booklet-flutter-component-recipes.html">Flutter Cookbook</a> as well:</p>
<p><img alt="Canvas-Painting" src="https://ptyagicodecamp.github.io/paint_canvas_1.jpg"></p>
<hr>
<p><strong>Checkout the companion video tutorial:</strong>
<iframe width="560" height="315" src="https://www.youtube.com/embed/44o5EShxBoM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></p>
<hr>
<h3>Drawing / Painting Area</h3>
<p>Let's go ahead with building main area of the finger painting app. In this app, a picture of hut is displayed as background to color in. User can color this page while adding more details to the picture using tools provided by the app.</p>
<p>We'll be using <a href="">'StatefulWidget'</a> to implement the app. This is because we need to convert the user's tap into drawing/painting while updating the finger movement on the screen.</p>
<p><strong>Note:</strong> You can either choose to run this sample from <code>main()</code> method or invoke it from Flutter Cookbook app as mentioned above.</p>
<div class="highlight"><pre><span></span><span class="c1">//Optional app&#39;s entry point. Uncomment if running only this file.</span>
<span class="c1">//Note: Following line should be commented out when running Flutter Cookbook App on Web platform</span>
<span class="k">void</span> <span class="nx">main</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">runApp</span><span class="p">(</span><span class="nx">CanvasPainting</span><span class="p">());</span>

<span class="c1">//StatefulWidget</span>
<span class="kr">class</span> <span class="nx">CanvasPainting</span> <span class="kr">extends</span> <span class="nx">StatefulWidget</span> <span class="p">{</span>
  <span class="kd">@override</span>
  <span class="nx">_CanvasPaintingState</span> <span class="nx">createState</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">_CanvasPaintingState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kr">class</span> <span class="nx">_CanvasPaintingState</span> <span class="kr">extends</span> <span class="nx">State</span><span class="o">&lt;</span><span class="nx">CanvasPainting</span><span class="o">&gt;</span> <span class="p">{</span>
 <span class="p">...</span>
  <span class="kd">@override</span>
  <span class="nx">Widget</span> <span class="nx">build</span><span class="p">(</span><span class="nx">BuildContext</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MaterialApp</span><span class="p">(</span>
      <span class="nx">debugShowCheckedModeBanner</span>: <span class="kt">false</span><span class="p">,</span>
      <span class="nx">home</span>: <span class="kt">Scaffold</span><span class="p">(</span>
        <span class="nx">body</span><span class="o">:</span> <span class="c1">//Main canvas goes here,</span>
        <span class="nx">floatingActionButton</span><span class="o">:</span> <span class="c1">//FAB for the menu items goes here,</span>
      <span class="p">),</span>
    <span class="p">);</span>
  <span class="p">}</span>
 <span class="p">...</span>
<span class="p">}</span>
</pre></div>


<p><strong>Detecting gestures:</strong></p>
<p>We need a way to capture the user's tap. The <a href="https://api.flutter.dev/flutter/widgets/GestureDetector-class.html"><code>GestureDetector</code></a> widget is used to detect gestures. This widget is assigned to <code>Scaffold</code> widget's <code>body</code> property.</p>
<p>Since we want to paint on the given hut image. Feel free to use another image if you would like. However, don't forget to add this image to <code>assets/images</code> folder. Put this image in the center of the screen using <code>Center</code> widget. We want to draw on top of this image, so put this widget inside a <code>Stack</code> widget. Add <code>CustomPaint</code> as another child to this <code>Stack</code> widget.</p>
<p><code>CustomPaint</code> widget takes two attributes. First, size of the canvas to be considered for drawing. Assign <code>Size.infinite</code> to <code>size</code> property because we want flexibility to be able draw anywhere on the screen.</p>
<p>Second, assign <code>painter</code> property to an instance of <code>CustomPainter</code> widget. We'll create a class <code>MyPainter</code> which extends <code>CustomPainter</code>. <code>MyPainter</code> class needs <code>pointsList</code>. This is the list of coordinates where screen is being touched. This information is required to draw either a line or a point on the screen.</p>
<div class="highlight"><pre><span></span>//List of points touched at screen
List&lt;TouchPoints&gt; points = List();
  ...
body: GestureDetector(
  child: Stack(
    children: &lt;Widget&gt;[
      Center(
        child: Image.asset(&quot;assets/images/hut.png&quot;),
      ),
      CustomPaint(
        size: Size.infinite,
        painter: MyPainter(
          pointsList: points,
        ),
      ),
    ],
  ),
),
</pre></div>


<p><strong>The <code>TouchPoints</code> class:</strong></p>
<p>This class holds the point information where screen is being touched.</p>
<div class="highlight"><pre><span></span><span class="c1">//Class to define a point touched at canvas</span>
<span class="kr">class</span> <span class="nx">TouchPoints</span> <span class="p">{</span>
  <span class="nx">Paint</span> <span class="nx">paint</span><span class="p">;</span>
  <span class="nx">Offset</span> <span class="nx">points</span><span class="p">;</span>
  <span class="nx">TouchPoints</span><span class="p">({</span><span class="k">this</span><span class="p">.</span><span class="nx">points</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">paint</span><span class="p">});</span>
<span class="p">}</span>
</pre></div>


<p><strong><code>MyPainter</code> class:</strong></p>
<p>The <code>MyPainter</code> class extends <code>CustomPainter</code>. It tells system how and when the screen will be painted. When two consecutive points are available, a line is detected otherwise a point is drawn.</p>
<div class="highlight"><pre><span></span><span class="kr">class</span> <span class="nx">MyPainter</span> <span class="kr">extends</span> <span class="nx">CustomPainter</span> <span class="p">{</span>
  <span class="nx">MyPainter</span><span class="p">({</span><span class="k">this</span><span class="p">.</span><span class="nx">pointsList</span><span class="p">});</span>

  <span class="c1">//Keep track of the points tapped on the screen</span>
  <span class="nx">List</span><span class="o">&lt;</span><span class="nx">TouchPoints</span><span class="o">&gt;</span> <span class="nx">pointsList</span><span class="p">;</span>
  <span class="nx">List</span><span class="o">&lt;</span><span class="nx">Offset</span><span class="o">&gt;</span> <span class="nx">offsetPoints</span> <span class="o">=</span> <span class="nx">List</span><span class="p">();</span>

  <span class="c1">//This is where we can draw on canvas.</span>
  <span class="kd">@override</span>
  <span class="k">void</span> <span class="nx">paint</span><span class="p">(</span><span class="nx">Canvas</span> <span class="nx">canvas</span><span class="p">,</span> <span class="nx">Size</span> <span class="nx">size</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kr">int</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">pointsList</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">pointsList</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">pointsList</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>

        <span class="c1">//Drawing line when two consecutive points are available</span>
        <span class="nx">canvas</span><span class="p">.</span><span class="nx">drawLine</span><span class="p">(</span><span class="nx">pointsList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">points</span><span class="p">,</span> <span class="nx">pointsList</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="nx">points</span><span class="p">,</span>
            <span class="nx">pointsList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">paint</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">pointsList</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">pointsList</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">offsetPoints</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
        <span class="nx">offsetPoints</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">pointsList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">points</span><span class="p">);</span>
        <span class="nx">offsetPoints</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">Offset</span><span class="p">(</span>
            <span class="nx">pointsList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">points</span><span class="p">.</span><span class="nx">dx</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span> <span class="nx">pointsList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">points</span><span class="p">.</span><span class="nx">dy</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">));</span>

        <span class="c1">//Draw points when two points are not next to each other</span>
        <span class="nx">canvas</span><span class="p">.</span><span class="nx">drawPoints</span><span class="p">(</span><span class="nx">PointMode</span><span class="p">.</span><span class="nx">points</span><span class="p">,</span> <span class="nx">offsetPoints</span><span class="p">,</span> <span class="nx">pointsList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">paint</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">//Called when CustomPainter is rebuilt.</span>
  <span class="c1">//Returning true because we want canvas to be rebuilt to reflect new changes.</span>
  <span class="kd">@override</span>
  <span class="kt">bool</span> <span class="nx">shouldRepaint</span><span class="p">(</span><span class="nx">MyPainter</span> <span class="nx">oldDelegate</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>At this point, our canvas is ready to process the touched points on the screen. However, we need to add detect and register this touched down points. For this purpose, we'll use <code>GestureDetector</code> widget's following properties:</p>
<ul>
<li><strong>The <code>onPanStart</code> property:</strong></li>
</ul>
<p>This property records the initial touched points. It requires <code>paint</code> property to provide information how touched points would be rendered on the screen. It extracts the position of touched points using <a href="https://api.flutter.dev/flutter/rendering/RenderBox-class.html"><code>RenderBox</code></a> widget. A <code>RenderBox</code> is a render object in a 2D Cartesian coordinate system.</p>
<p>Here's description of this property from its class:</p>
<blockquote>
<p>A pointer has contacted the screen with a primary button and has begun to move.</p>
</blockquote>
<div class="highlight"><pre><span></span><span class="x"> </span><span class="nx">onPanStart</span><span class="p">:</span> <span class="p">(</span><span class="nx">details</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">setState</span><span class="p">(()</span> <span class="p">{</span>
    <span class="nx">RenderBox</span> <span class="n">renderBox</span><span class="o"> =</span> <span class="nx">context.findRenderObject</span><span class="p">();</span>
    <span class="nx">points.add</span><span class="p">(</span><span class="nx">TouchPoints</span><span class="p">(</span>
        <span class="nx">points</span><span class="p">:</span> <span class="nx">renderBox.globalToLocal</span><span class="p">(</span><span class="nx">details.globalPosition</span><span class="p">),</span>
        <span class="nx">paint</span><span class="p">:</span> <span class="nx">Paint</span><span class="p">()</span>
          <span class="bp">..</span><span class="nx nx-Member">strokeCap</span> <span class="o">=</span> <span class="nx">strokeType</span>
          <span class="bp">..</span><span class="nx nx-Member">isAntiAlias</span> <span class="o">=</span> <span class="kc">true</span>
          <span class="bp">..</span><span class="nx nx-Member">color</span> <span class="o">=</span> <span class="nx">selectedColor.withOpacity</span><span class="p">(</span><span class="nx">opacity</span><span class="p">)</span>
          <span class="bp">..</span><span class="nx nx-Member">strokeWidth</span> <span class="o">=</span> <span class="nx">strokeWidth</span><span class="p">));</span>
  <span class="p">});</span>
<span class="p">},</span>
</pre></div>


<p>Let's define default properties for <code>Paint()</code> object as below:</p>
<div class="highlight"><pre><span></span> double opacity = 1.0;
 StrokeCap strokeType = StrokeCap.round;
 double strokeWidth = 3.0;
 Color selectedColor = Colors.black;
</pre></div>


<ul>
<li><strong>The <code>onPanUpdate</code> property:</strong></li>
</ul>
<p>This property is used to update the moving coordinates. For example, user is drawing a line without lifting off their finger.</p>
<p>Here's description of this property from its class:</p>
<blockquote>
<p>A pointer that is in contact with the screen with a primary button and moving has moved again.</p>
</blockquote>
<div class="highlight"><pre><span></span><span class="x"> </span><span class="nx">onPanUpdate</span><span class="p">:</span> <span class="p">(</span><span class="nx">details</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">setState</span><span class="p">(()</span> <span class="p">{</span>
     <span class="nx">RenderBox</span> <span class="n">renderBox</span><span class="o"> =</span> <span class="nx">context.findRenderObject</span><span class="p">();</span>
     <span class="nx">points.add</span><span class="p">(</span><span class="nx">TouchPoints</span><span class="p">(</span>
         <span class="nx">points</span><span class="p">:</span> <span class="nx">renderBox.globalToLocal</span><span class="p">(</span><span class="nx">details.globalPosition</span><span class="p">),</span>
         <span class="nx">paint</span><span class="p">:</span> <span class="nx">Paint</span><span class="p">()</span>
           <span class="bp">..</span><span class="nx nx-Member">strokeCap</span> <span class="o">=</span> <span class="nx">strokeType</span>
           <span class="bp">..</span><span class="nx nx-Member">isAntiAlias</span> <span class="o">=</span> <span class="kc">true</span>
           <span class="bp">..</span><span class="nx nx-Member">color</span> <span class="o">=</span> <span class="nx">selectedColor.withOpacity</span><span class="p">(</span><span class="nx">opacity</span><span class="p">)</span>
           <span class="bp">..</span><span class="nx nx-Member">strokeWidth</span> <span class="o">=</span> <span class="nx">strokeWidth</span><span class="p">));</span>
   <span class="p">});</span>
 <span class="p">},</span>
</pre></div>


<ul>
<li><strong>The <code>onPanEnd</code> property:</strong></li>
</ul>
<p>This point describes the end of the screen contact with finger. So <code>null</code> is added to <code>points</code> list because there's no <code>TouchPoints</code> to be recorded.</p>
<p>Here's description of this property from its class:</p>
<blockquote>
<p>A pointer that was previously in contact with the screen with a primary button and moving is no longer in contact with the screen and was moving at a specific velocity when it stopped contacting the screen.</p>
</blockquote>
<div class="highlight"><pre><span></span> onPanEnd: (details) {
  setState(() {
    points.add(null);
  });
},
</pre></div>


<hr>
<h2>Action Items</h2>
<p>There are following 7 action items that we want to add our toolkit.</p>
<ul>
<li>Brush Stroke Picker</li>
<li>Opacity Picker</li>
<li>Resetting Screen</li>
<li>Red Color Picker</li>
<li>Green Color Picker</li>
<li>Pink Color Picker</li>
<li>Blue Color Picker</li>
</ul>
<h3>Add FAB menu</h3>
<p>The FAB menu is implemented using <code>AnimatedFloatingActionButton</code> widget. This widget provides nice and smooth animation for menu open and close actions. It's assigned to <code>Scaffold</code> widget using <code>floatingActionButton</code> property.</p>
<h4><code>pubspec.yaml</code> Configuration</h4>
<p>The <code>AnimatedFloatingActionButton</code> widget is provided by a Flutter plugin. Add plugin <code>animated_floatactionbuttons: ^0.1.0</code> to <code>pubspec.yaml</code></p>
<div class="highlight"><pre><span></span>  animated_floatactionbuttons: ^0.1.0
</pre></div>


<p><strong>Note:</strong> Don't forget to fetch the flutter packages after adding dependency.</p>
<h4>Animating FAB</h4>
<p>When FAB menu is clicked, it shows swift animation. We provide colors for starting and ending animation.</p>
<p>The <code>Colors.blue</code> is used as starting animation color. This can be assigned using <code>colorStartAnimation</code> property. The property <code>colorEndAnimation</code> is used to assign ending animation color, <code>Colors.cyan</code>.</p>
<p>When FAB menu open and closes, its icon(s) is changed using <code>animatedIconData</code> property.</p>
<p>This is how different colors can be assigned to <code>AnimatedFloatingActionButton</code> widget:</p>
<div class="highlight"><pre><span></span><span class="n">floatingActionButton</span><span class="o">:</span> <span class="n">AnimatedFloatingActionButton</span><span class="o">(</span>

  <span class="c1">//Color shown when animation starts</span>
  <span class="n">colorStartAnimation</span><span class="o">:</span> <span class="n">Colors</span><span class="o">.</span><span class="na">blue</span><span class="o">,</span>

  <span class="c1">//Color shown when animation ends</span>
  <span class="n">colorEndAnimation</span><span class="o">:</span> <span class="n">Colors</span><span class="o">.</span><span class="na">cyan</span><span class="o">,</span>

  <span class="c1">//Icon for FAB. &#39;X&#39; icon is shown when menu is open.</span>
  <span class="n">animatedIconData</span><span class="o">:</span> <span class="n">AnimatedIcons</span><span class="o">.</span><span class="na">menu_close</span><span class="o">,</span>
<span class="o">),</span>
</pre></div>


<h4>Adding the buttons to FAB</h4>
<p>The <code>fabButtons</code> property takes the buttons to be added to the <code>AnimatedFloatingActionButton</code> widget.
We'll create <code>fabOption()</code> to return list of widgets to be shown as menu items.</p>
<p>Checkout the full code below:</p>
<div class="highlight"><pre><span></span><span class="c1">//Optional app&#39;s entry point</span>
<span class="k">void</span> <span class="nx">main</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">runApp</span><span class="p">(</span><span class="nx">CanvasPainting</span><span class="p">());</span>

<span class="c1">//StatefulWidget</span>
<span class="kr">class</span> <span class="nx">CanvasPainting</span> <span class="kr">extends</span> <span class="nx">StatefulWidget</span> <span class="p">{</span>
  <span class="kd">@override</span>
  <span class="nx">_CanvasPaintingState</span> <span class="nx">createState</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">_CanvasPaintingState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kr">class</span> <span class="nx">_CanvasPaintingState</span> <span class="kr">extends</span> <span class="nx">State</span><span class="o">&lt;</span><span class="nx">CanvasPainting</span><span class="o">&gt;</span> <span class="p">{</span>
 <span class="p">...</span>
  <span class="kd">@override</span>
  <span class="nx">Widget</span> <span class="nx">build</span><span class="p">(</span><span class="nx">BuildContext</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MaterialApp</span><span class="p">(</span>
      <span class="nx">debugShowCheckedModeBanner</span>: <span class="kt">false</span><span class="p">,</span>
      <span class="nx">home</span>: <span class="kt">Scaffold</span><span class="p">(</span>
        <span class="nx">body</span><span class="o">:</span> <span class="c1">//Main canvas goes here,</span>

        <span class="c1">//FAB to implement expandable menu</span>
        <span class="c1">//needs plugin: `animated_floatactionbuttons`</span>
        <span class="nx">floatingActionButton</span>: <span class="kt">AnimatedFloatingActionButton</span><span class="p">(</span>

          <span class="c1">//Creating menu items</span>
          <span class="nx">fabButtons</span>: <span class="kt">fabOption</span><span class="p">(),</span>

          <span class="c1">//Color shown when animation starts</span>
          <span class="nx">colorStartAnimation</span>: <span class="kt">Colors.blue</span><span class="p">,</span>

          <span class="c1">//Color shown when animation ends</span>
          <span class="nx">colorEndAnimation</span>: <span class="kt">Colors.cyan</span><span class="p">,</span>

          <span class="c1">//Icon for FAB</span>
          <span class="nx">animatedIconData</span>: <span class="kt">AnimatedIcons.menu_close</span><span class="p">,</span>
        <span class="p">),</span>
      <span class="p">),</span>
    <span class="p">);</span>
  <span class="p">}</span>
 <span class="p">...</span>
<span class="p">}</span>
</pre></div>


<p>Let's checkout the <code>fabOption()</code> method next.</p>
<hr>
<h3>The <code>fabOption()</code> method</h3>
<p>The method <code>fabOption()</code> returns the list of all menu items in the FAB menu. Assign this method to <code>AnimatedFloatingActionButton</code> widget using <code>fabButtons</code> property.</p>
<div class="highlight"><pre><span></span>List&lt;Widget&gt; fabOption() {
  return &lt;Widget&gt;[

    //FAB for choosing stroke
    FloatingActionButton(
      heroTag: &quot;paint_stroke&quot;,
      child: Icon(Icons.brush),
      tooltip: &#39;Stroke&#39;,
      onPressed: () {
        //min: 0, max: 50
        setState(() {
          _pickStroke();
        });
      },
    ),

    //FAB for choosing opacity
    FloatingActionButton(
      heroTag: &quot;paint_opacity&quot;,
      child: Icon(Icons.opacity),
      tooltip: &#39;Opacity&#39;,
      onPressed: () {
        //min:0, max:1
        setState(() {
          _opacity();
        });
      },
    ),

    //FAB for resetting screen
    FloatingActionButton(
        heroTag: &quot;erase&quot;,
        child: Icon(Icons.clear),
        tooltip: &quot;Erase&quot;,
        onPressed: () {
          setState(() {
            points.clear();
          });
        }),

    //FAB for picking red color    
    FloatingActionButton(
      backgroundColor: Colors.white,
      heroTag: &quot;color_red&quot;,
      child: colorMenuItem(Colors.red),
      tooltip: &#39;Color&#39;,
      onPressed: () {
        setState(() {
          selectedColor = Colors.red;
        });
      },
    ),

    //FAB for picking green color
    FloatingActionButton(
      backgroundColor: Colors.white,
      heroTag: &quot;color_green&quot;,
      child: colorMenuItem(Colors.green),
      tooltip: &#39;Color&#39;,
      onPressed: () {
        setState(() {
          selectedColor = Colors.green;
        });
      },
    ),

    //FAB for picking pink color
    FloatingActionButton(
      backgroundColor: Colors.white,
      heroTag: &quot;color_pink&quot;,
      child: colorMenuItem(Colors.pink),
      tooltip: &#39;Color&#39;,
      onPressed: () {
        setState(() {
          selectedColor = Colors.pink;
        });
      },
    ),

    //FAB for picking blue color
    FloatingActionButton(
      backgroundColor: Colors.white,
      heroTag: &quot;color_blue&quot;,
      child: colorMenuItem(Colors.blue),
      tooltip: &#39;Color&#39;,
      onPressed: () {
        setState(() {
          selectedColor = Colors.blue;
        });
      },
    ),
  ];
}
</pre></div>


<hr>
<h3>Opacity Picker</h3>
<p>The <a href="https://api.flutter.dev/flutter/widgets/Opacity-class.html">Opacity</a> widget makes its child partially transparent. We want to support three values in our toolkit to pick from: 0.1, 0.5, and 1.0. The <code>0.1</code> is most transparent while <code>1.0</code> not at all. These options are shown in a alert dialog like below:</p>
<p><img alt="Canvas-Painting" src="https://ptyagicodecamp.github.io/paint_canvas_4.jpg"></p>
<p>This is how your stroke look for opacity value of <code>0.1</code>:</p>
<p><img alt="Canvas-Painting" src="https://ptyagicodecamp.github.io/paint_canvas_6.jpg"></p>
<p><strong>Implementing <code>_opacity()</code> method:</strong></p>
<p>The <code>_opacity()</code> method implements selection of opacity as show in the screenshot.</p>
<p>We're providing three different values for opacity. The <code>opacity = 1.0</code> is the maximum opacity. All options are displayed in <code>AlertDialog</code> widget. Selecting one option closes the dialog.</p>
<p>We'll use <a href="https://api.flutter.dev/flutter/widgets/ModalRoute/barrierDismissible.html"><code>barrierDismissible</code></a> to enable user to tap anywhere on the screen to close this dialog box.</p>
<p><a href="https://api.flutter.dev/flutter/widgets/ClipOval-class.html"><code>ClipOval</code></a> widget is used to create an oval shape clip of its child. You would notice slightly rounded corners for <code>AlertDialog</code> child.</p>
<div class="highlight"><pre><span></span>Future&lt;void&gt; _opacity() async {
  //Shows AlertDialog
  return showDialog&lt;void&gt;(
    context: context,

    //Dismiss alert dialog when set true
    barrierDismissible: true,

    builder: (BuildContext context) {

      //Clips its child in a oval shape
      return ClipOval(
        child: AlertDialog(

          //Creates three buttons to pick opacity value.
          actions: &lt;Widget&gt;[
            FlatButton(
              child: Icon(
                Icons.opacity,
                size: 24,
              ),
              onPressed: () {
                //most transparent
                opacity = 0.1;
                Navigator.of(context).pop();
              },
            ),
            FlatButton(
              child: Icon(
                Icons.opacity,
                size: 40,
              ),
              onPressed: () {
                opacity = 0.5;
                Navigator.of(context).pop();
              },
            ),
            FlatButton(
              child: Icon(
                Icons.opacity,
                size: 60,
              ),
              onPressed: () {
                //not transparent at all.
                opacity = 1.0;
                Navigator.of(context).pop();
              },
            ),
          ],
        ),
      );
    },
  );
}
</pre></div>


<hr>
<h3>Brush Stroke Picker</h3>
<p>The <a href="https://api.flutter.dev/flutter/dart-ui/Paint/strokeWidth.html"><code>strokeWidth</code></a> property sets the width of the stroke. .</p>
<p>These options are shown in the alert dialog like below. The 'X' is for resetting the stroke to its default value. The other three values are <code>10.0</code>(thicker than default), <code>30.0</code>, and <code>50.0</code> (thickest stroke).  </p>
<p><img alt="Canvas-Painting" src="https://ptyagicodecamp.github.io/paint_canvas_5.jpg"></p>
<p>The following screenshot shows all three options marked as 1, 2, and 3, where 1 is <code>10.0</code>, 2 is <code>30.0</code>, and 3 is <code>50.0</code>.</p>
<p><img alt="Canvas-Painting" src="https://ptyagicodecamp.github.io/paint_canvas_7.jpg"></p>
<p><strong>Implementing <code>_pickStroke()</code> method:</strong></p>
<p>The <code>_pickStroke()</code> method implements selection of the stroke.</p>
<p>We're providing four different width of strokes. All options are displayed in the
<code>AlertDialog</code> widget. Selecting one option closes the dialog.</p>
<div class="highlight"><pre><span></span>Future&lt;void&gt; _pickStroke() async {

  //Shows AlertDialog
  return showDialog&lt;void&gt;(
    context: context,

    //Dismiss alert dialog when set true
    barrierDismissible: true, // user must tap button!
    builder: (BuildContext context) {

      //Clips its child in a oval shape
      return ClipOval(
        child: AlertDialog(

          //Creates three buttons to pick stroke value.
          actions: &lt;Widget&gt;[

            //Resetting to default stroke value
            FlatButton(
              child: Icon(
                Icons.clear,
              ),
              onPressed: () {
                strokeWidth = 3.0;
                Navigator.of(context).pop();
              },
            ),
            FlatButton(
              child: Icon(
                Icons.brush,
                size: 24,
              ),
              onPressed: () {
                strokeWidth = 10.0;
                Navigator.of(context).pop();
              },
            ),
            FlatButton(
              child: Icon(
                Icons.brush,
                size: 40,
              ),
              onPressed: () {
                strokeWidth = 30.0;
                Navigator.of(context).pop();
              },
            ),
            FlatButton(
              child: Icon(
                Icons.brush,
                size: 60,
              ),
              onPressed: () {
                strokeWidth = 50.0;
                Navigator.of(context).pop();
              },
            ),
          ],
        ),
      );
    },
  );
}
</pre></div>


<hr>
<h3>Resetting Screen</h3>
<p>Resetting screen clears all the recorded points:</p>
<div class="highlight"><pre><span></span>points.clear();
</pre></div>


<hr>
<h3>Red, Green, Pink &amp; Blue Color Picker(s)</h3>
<p>The <code>colorMenuItem(Color color)</code> method provides the icon(s) for the given color(s). Tapping on that icon makes the color selection. <code>ClipOval</code> widget is used to give smooth round shape to colored icon.</p>
<div class="highlight"><pre><span></span><span class="nt">Widget</span> <span class="nt">colorMenuItem</span><span class="o">(</span><span class="nt">Color</span> <span class="nt">color</span><span class="o">)</span> <span class="p">{</span>
  <span class="err">return</span> <span class="err">GestureDetector(</span>
    <span class="n">onTap</span><span class="p">:</span> <span class="p">()</span> <span class="err">{</span>
      <span class="nf">setState</span><span class="p">(</span><span class="err">(</span><span class="p">)</span> <span class="err">{</span>
        <span class="n">selectedColor</span> <span class="o">=</span> <span class="kc">color</span><span class="p">;</span>
      <span class="p">}</span><span class="o">);</span>
    <span class="err">}</span><span class="o">,</span>
    <span class="nt">child</span><span class="o">:</span> <span class="nt">ClipOval</span><span class="o">(</span>
      <span class="nt">child</span><span class="o">:</span> <span class="nt">Container</span><span class="o">(</span>
        <span class="nt">padding</span><span class="o">:</span> <span class="nt">const</span> <span class="nt">EdgeInsets</span><span class="p">.</span><span class="nc">only</span><span class="o">(</span><span class="nt">bottom</span><span class="o">:</span> <span class="nt">8</span><span class="p">.</span><span class="nc">0</span><span class="o">),</span>
        <span class="nt">height</span><span class="o">:</span> <span class="nt">36</span><span class="o">,</span>
        <span class="nt">width</span><span class="o">:</span> <span class="nt">36</span><span class="o">,</span>
        <span class="nt">color</span><span class="o">:</span> <span class="nt">color</span><span class="o">,</span>
      <span class="o">),</span>
    <span class="o">),</span>
  <span class="o">);</span>
<span class="err">}</span>
</pre></div>


<p>The above <code>colorMenuItem(...)</code> method is used to create oval menu items for all the four colors.</p>
<p>That's all for this article. Hope you've your own finger painting app on your finger tips :)</p>
<hr>
<p><strong>NOTE:</strong> This code has been developed in following dev environment:</p>
<div class="highlight"><pre><span></span>Flutter 1.15.17 • channel beta • https://github.com/flutter/flutter.git
Framework • revision 2294d75bfa (4 weeks ago) • 2020-03-07 00:28:38 +0900
Engine • revision 5aff311948
Tools • Dart 2.8.0 (build 2.8.0-dev.12.0 9983424a3c)
</pre></div>


<hr>
<h3>Source code repo</h3>
<ul>
<li>
<p>Recipe source code is available <a href="https://github.com/ptyagicodecamp/flutter_cookbook/blob/widgets/flutter_widgets/lib/canvas/painting.dart">here</a></p>
</li>
<li>
<p>Code recipe project's source code is available <a href="https://github.com/ptyagicodecamp/flutter_cookbook/tree/widgets/flutter_widgets/">here</a></p>
</li>
</ul>
<h3>References:</h3>
<ol>
<li><a href="https://api.flutter.dev/flutter/widgets/GestureDetector-class.html">GestureDetector</a></li>
<li><a href="https://api.flutter.dev/flutter/widgets/CustomPaint-class.html">CustomPaint</a></li>
</ol>
<p>Happy cooking with Flutter :)</p>
<p><em>Liked the article ?
Couldn't find a topic of your interest ? Please leave comments or <a href="mailto:ptyagicodecamp@gmail.com">email me</a> about topics you would like me to write !
<a href="https://www.paypal.me/pritya">BTW I love cupcakes and coffee both :)</a></em></p>
<p>Follow me at <a href="https://twitter.com/ptyagi13">twitter</a></p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://ptyagicodecamp.github.io/tag/canvas.html">Canvas</a>
      <a href="https://ptyagicodecamp.github.io/tag/painting.html">Painting</a>
      <a href="https://ptyagicodecamp.github.io/tag/cross-platform.html">Cross-platform</a>
      <a href="https://ptyagicodecamp.github.io/tag/flutter.html">Flutter</a>
      <a href="https://ptyagicodecamp.github.io/tag/code-recipes.html">Code-recipes</a>
      <a href="https://ptyagicodecamp.github.io/tag/android.html">Android</a>
      <a href="https://ptyagicodecamp.github.io/tag/android-studio.html">Android Studio</a>
      <a href="https://ptyagicodecamp.github.io/tag/ios.html">iOS</a>
      <a href="https://ptyagicodecamp.github.io/tag/development.html">development</a>
    </p>
  </div>

  <div class="center social-share">
    <p>    Like this article? Share it with your friends!
</p>
    <div class="addthis_native_toolbox"></div>
    <div class="addthis_sharing_toolbox"></div>
    <div class="addthis_inline_share_toolbox"></div>
  </div>


    <div class="addthis_relatedposts_inline"></div>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle ads-responsive"
         data-ad-client="ca-pub-6359982310050489"
         data-ad-slot="6546879945"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'https-ptyagicodecamp-github-io';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
<!-- End Disqus -->
</article>

    <footer>
<p>
  &copy;  2020 - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>
</p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>


    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5cf387135c8761da" async="async"></script>


<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " techLog ",
  "url" : "https://ptyagicodecamp.github.io",
  "image": "https://ptyagicodecamp.github.io/images/profile.jpg",
  "description": "Mobile engineering tech logger."
}
</script>

<a href="https://github.com/ptyagicodecamp" class="github-corner" aria-label="View source on Github">
    <svg width="80"
         height="80"
         viewBox="0 0 250 250"
         style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;"
         aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor"
              style="transform-origin: 130px 106px;"
              class="octo-arm">
        </path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor"
              class="octo-body">
        </path>
    </svg>
</a>
<style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style></body>
</html>