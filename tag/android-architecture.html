<!DOCTYPE html>
<!--[if lt IE 7]>      <html lang="en" class="no-js lt-ie9 lt-ie8 lt-ie7" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/Blog"> <![endif]-->
<!--[if IE 7]>         <html lang="en" class="no-js lt-ie9 lt-ie8" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/Blog"> <![endif]-->
<!--[if IE 8]>         <html lang="en" class="no-js lt-ie9" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/Blog"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="en" class="no-js" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/Blog"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>techLog - android-architecture tag</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<link rel="shortcut icon" href="http://ptyagicodecamp.github.io/" type="">
<meta name="author" content="Priyanka Tyagi">
<meta name="copyright" content="Priyanka Tyagi">
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta property="og:site_name" content="techLog" />
<meta property="og:title" content="techLog" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://ptyagicodecamp.github.io" />
<meta name="twitter:url" content="http://ptyagicodecamp.github.io" />
<meta itemprop="name" content="techLog" />
<meta itemprop="url" content="http://ptyagicodecamp.github.io"/>
<link href="http://ptyagicodecamp.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="techLog ATOM Feed"/>
<link href='//fonts.googleapis.com/css?family=Open+Sans:800italic' rel='stylesheet' type='text/css'>
<link href='//fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/uikit/2.15.0/css/uikit.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/uikit/2.15.0/css/components/search.min.css">
<link rel="stylesheet" href="/theme/css/tipuesearch.css">
<link rel="stylesheet" href="/theme/css/solarized.css">
<link rel="stylesheet" href="/theme/css/main.css">

<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
</head>
<body>
<!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

<header class=" mg-header uk-navbar uk-navbar-attached">

    <div class="uk-container uk-container-center">
        <div class="uk-grid" data-uk-grid-margin>

            <a class="mg-brand uk-navbar-brand uk-hidden-small" href="http://ptyagicodecamp.github.io">techLog</a>
            <div class="mg-tagline uk-navbar-content uk-hidden-small"></div>
            <a class="uk-navbar-toggle uk-visible-small" href="#mg-offcanvas" data-uk-offcanvas></a>
            <a class="mg-brand uk-navbar-brand uk-navbar-center uk-visible-small" href="http://ptyagicodecamp.github.io">techLog</a>

        </div>
    </div>
</header>

<main class="mg-main">

<div class="uk-container uk-container-center">

    <div class="uk-grid" data-uk-grid-margin>
        
<div class="uk-width-medium-4-5">


            <article class="uk-article" itemtype="http://schema.org/BlogPosting" itemscope="itemscope" itemprop="blogPost">
                <a href="http://ptyagicodecamp.github.io/managing-apps-lifecycle-using-lifecycle-aware-components-part-1.html" class="uk-article-title uk-link-muted" itemprop="name">Managing App's Lifecycle using "Lifecycle Aware components" (Part 1)</a>
                <p class="uk-article-meta"><time datetime="2017-08-12" itemprop="datePublished">Sat 12 August 2017</time> â€¢ <a href="http://ptyagicodecamp.github.io/category/development.html">Development</a></p>
</p>
                <p class="uk-article-lead" itemprop="description">This post is first part of 3 parts series about recently introduced architecture components.</p>
                <section itemprop="articleBody"><p>This covers using ViewModel component to persist Activity configuration data across screen rotations.</p>
<h2>Managing App's Lifecycle using "Lifecycle Aware components" (ViewModel)</h2>
<h3>Introduction</h3>
<p>This post is first part of 3 parts series about recently introduced architecture components.
This covers using ViewModel component to persist Activity configuration data across screen rotations.</p>
<p>This sample demonstrate how an app's lifecycle can be managed using recently introduced
lifecycle aware components. Classes that can work with <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html">Lifecyle</a>
are known as lifecycle aware components.</p>
<p>These components helps app to :
<em> Survive configuration changes.
</em> Avoid memory leaks.
* Easy data loading into app's UI.</p>
<p>Above is achieved using these libraries:
* <strong><a href="https://developer.android.com/topic/libraries/architecture/livedata.html">LiveData</a></strong>:
 LiveData is a data holder that keeps a value and allows it to be observed with in a specified lifecycle.</p>
<ul>
<li>
<p><strong><a href="https://developer.android.com/topic/libraries/architecture/viewmodel.html">ViewModel</a></strong>:
ViewModel class helps to store and manage data related to UI. Keeping UI related data in a separate
ViewModel class helps to survive activity configuration data across screen rotation. Basically, ViewModel
class prepares and provide data for/to UI.</p>
</li>
<li>
<p><strong><a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleOwner.html">LifecycleOwner</a></strong>:
It's a class that has an Android Life cycle. Your Fragment/Activity may want to extend on of its
subclasses like LifecycleFragment/LifecycleActivity to incorporate automatic handling of Lifecycle events.</p>
</li>
<li>
<p><strong><a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleObserver.html">LifecycleObserver</a></strong>:
Marks a class as a LifecycleObserver.</p>
</li>
</ul>
<p><strong><em>Useful links:</em></strong>
* <a href="https://developer.android.com/topic/libraries/architecture/adding-components.html">Importing architecture components to your project</a></p>
<h3>Set up</h3>
<p>I'm using Android Studio 3.0 Beta1.</p>
<p><code>build.gradle</code> dependencies for ViewModel, Lifecycle and LiveData:</p>
<div class="highlight"><pre><span></span>dependencies {
    compile &quot;android.arch.lifecycle:runtime:1.0.0-alpha5&quot;
    compile &quot;android.arch.lifecycle:extensions:1.0.0-alpha5&quot;
    annotationProcessor &quot;android.arch.lifecycle:compiler:1.0.0-alpha5&quot;
}
</pre></div>


<h3>Using ViewModel to retain data across lifecylce of Activity/Fragment</h3>
<p>I've a sample app with a simple <code>TextView</code>. This textView displays a text
'Hello Random Number: <generated random number>'. This number is generated and set in
<code>onCreate()</code> method.</p>
<h3>Before (Regular implementation)</h3>
<p>Every time screen is rotated, <code>onCreate()</code> method is called and generates
a new random number.  This is how <code>HelloRandomNumberActivity</code> looks like:</p>
<div class="highlight"><pre><span></span><span class="nt">public</span> <span class="nt">class</span> <span class="nt">HelloRandomNumberActivity</span> <span class="nt">extends</span> <span class="nt">AppCompatActivity</span> <span class="p">{</span>

    <span class="err">@Override</span>
    <span class="err">protected</span> <span class="err">void</span> <span class="err">onCreate(Bundle</span> <span class="err">savedInstanceState)</span> <span class="err">{</span>
        <span class="err">super.onCreate(savedInstanceState)</span><span class="p">;</span>
        <span class="err">setContentView(R.layout.activity_hello_random_number)</span><span class="p">;</span>

        <span class="err">TextView</span> <span class="err">textView</span> <span class="err">=</span> <span class="err">findViewById(R.id.helloRandomNumber)</span><span class="p">;</span>
        <span class="err">double</span> <span class="err">randomNumber</span> <span class="err">=</span> <span class="err">Math.random()</span><span class="p">;</span>

        <span class="err">textView.setText(&quot;Hello</span> <span class="err">Random</span> <span class="n">Number</span><span class="p">:</span> <span class="err">&quot;</span> <span class="o">+</span> <span class="n">randomNumber</span><span class="p">);</span>
    <span class="p">}</span>
<span class="err">}</span>
</pre></div>


<p>Feel free to try and run this code in action. You'll see every time you rotate your device's screen,
a new random number is generated and displayed.</p>
<p><a href="https://youtu.be/gbDnwYyHh_I">Checkout this video to see how screen rotation will re-generate new number again</a></p>
<h3>After (Using ViewModel to retain Activity config data)</h3>
<p>I'll be using <a href="https://developer.android.com/topic/libraries/architecture/viewmodel.html">ViewModel</a>
component to achieve the data persistence across screen rotations.</p>
<p>Here's is ViewModel to keep track of random number generated:</p>
<div class="highlight"><pre><span></span>public class RandomNumberViewModel extends ViewModel {

    @Nullable
    private Double randomNumber;

    @Nullable
    public Double getRandomNumber() {
        return randomNumber;
    }

    public void setRandomNumber(Double randomNumber) {
        this.randomNumber = randomNumber;
    }
}
</pre></div>


<p>This is how <code>HelloRandomNumberActivity</code> looks like now:</p>
<div class="highlight"><pre><span></span><span class="nt">public</span> <span class="nt">class</span> <span class="nt">HelloRandomNumberActivity</span> <span class="nt">extends</span> <span class="nt">LifecycleActivity</span> <span class="p">{</span>

    <span class="err">@Override</span>
    <span class="err">protected</span> <span class="err">void</span> <span class="err">onCreate(Bundle</span> <span class="err">savedInstanceState)</span> <span class="err">{</span>
        <span class="err">super.onCreate(savedInstanceState)</span><span class="p">;</span>
        <span class="err">setContentView(R.layout.activity_hello_random_number)</span><span class="p">;</span>

        <span class="err">//ViewModelStore</span> <span class="err">provides</span> <span class="err">a</span> <span class="err">new</span> <span class="err">ViewModel</span> <span class="err">or</span> <span class="err">one</span> <span class="err">previously</span> <span class="err">created.</span>
        <span class="err">RandomNumberViewModel</span> <span class="err">randomNumberViewModel</span> <span class="err">=</span>
                <span class="err">ViewModelProviders.of(this).get(RandomNumberViewModel.class)</span><span class="p">;</span>

        <span class="err">TextView</span> <span class="err">textView</span> <span class="err">=</span> <span class="err">findViewById(R.id.helloRandomNumber)</span><span class="p">;</span>
        <span class="err">String</span> <span class="err">text</span> <span class="err">=</span> <span class="err">&quot;Hello</span> <span class="err">Random</span> <span class="n">Number</span><span class="p">:</span> <span class="err">&quot;</span><span class="p">;</span>

        <span class="err">if</span> <span class="err">(randomNumberViewModel.getRandomNumber()</span> <span class="err">==</span> <span class="err">null)</span> <span class="err">{</span>
            <span class="err">double</span> <span class="err">randomNumber</span> <span class="err">=</span> <span class="err">Math.random()</span><span class="p">;</span>
            <span class="err">//assigning</span> <span class="err">value</span> <span class="err">to</span> <span class="err">ViewModel</span>
            <span class="err">randomNumberViewModel.setRandomNumber(randomNumber)</span><span class="p">;</span>
            <span class="err">textView.setText(text</span> <span class="err">+</span> <span class="err">randomNumber)</span><span class="p">;</span>
        <span class="p">}</span> <span class="nt">else</span> <span class="p">{</span>
            <span class="err">//display</span> <span class="err">data</span> <span class="err">from</span> <span class="err">previous</span> <span class="err">retained</span> <span class="err">ViewModel</span>
            <span class="err">textView.setText(text</span> <span class="err">+</span> <span class="err">randomNumberViewModel.getRandomNumber())</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="err">}</span>
<span class="err">}</span>
</pre></div>


<p><strong><em>Note</em></strong>: You may noticed that 'AppCompatActivity' is replaced with 'LifecycleActivity'.
This is because lifecycle classes are not not supported in support libraries. Once Lifecycle classes
are release, then it'll be available in Support library and so in 'AppCompatActivity'.</p>
<p>Try the code now ! There's no change in number every time screen is rotated.</p>
<p><a href="https://youtu.be/2Mh7vYUDK3w">Checkout this video to see how introducing ViewModel helps retaining the
Activity configuration data</a></p>
<p>That's all you have to know to get started with using ViewModel architecture components in order to write better and maintainable android apps !</p>
<p>Checkout the source code at <a href="https://github.com/ptyagicodecamp/android-architecture/tree/master/lifecycle">Github</a></p>
<p>I'll cover LiveData architecture component in next post.</p>
<p>Happy exploring !</p></section>
                <a href="http://ptyagicodecamp.github.io/managing-apps-lifecycle-using-lifecycle-aware-components-part-1.html#disqus_thread"></a>
                <hr class="uk-article-divider">
            </article>


</div>
 
    
        <div class="uk-width-medium-1-5 uk-hidden-small">
            
            <div class="uk-panel uk-panel-box">
                <form class="uk-search" action="search.html" data-uk-search>
                    <input class="uk-search-field tipue_search" type="search" name="q" id="tipue_search_input" autocomplete="off" placeholder="Search...">
                </form>
            </div>

            <div class="uk-panel uk-panel-box">
                <ul class="uk-nav uk-nav-side">
                    <li class="uk-nav-header">Categories</li>
                    <li ><a href="http://ptyagicodecamp.github.io/category/development.html">Development</a></li>
                    <li class="uk-nav-header">Pages</li>
                    
                    

                    <li class="uk-nav-divider"></li>
                    <li ><a href="http://ptyagicodecamp.github.io/archives.html">Archives</a></li>
                </ul>
            </div>

            <div class="uk-panel uk-panel-box">
                <h3 class="uk-panel-title">Receive Updates</h3>
                <a rel="alternate" type="application/atom+xml" href="http://ptyagicodecamp.github.io/feeds/all.atom.xml" class="mg-feed"><i class="uk-icon-rss uk-icon-medium"></i> ATOM</a>
            </div>
            

        </div>

    </div>

</div>

</main>

<footer class="mg-footer">
    <div class="uk-container uk-container-center uk-text-center">

        <div class="mg-icons-small uk-subnav uk-visible-small">
            <li><a rel="alternate" type="application/atom+xml" href="http://ptyagicodecamp.github.io/feeds/all.atom.xml" class="uk-icon-button uk-icon-rss"></a></li>
        </div>

        <div class="mg-author uk-panel">
            <p></p>

            <p>Powered by <a href="http://blog.getpelican.com">Pelican</a>.<br class="uk-visible-small"> Theme <a href="https://github.com/lucachr/pelican-mg">mg</a> by <a href="https://github.com/lucachr">Luca Chiricozzi</a>.</p>
        </div>
    </div> 
</footer>

<div id="mg-offcanvas" class="uk-offcanvas">
    <div class="uk-offcanvas-bar">

        <form class="uk-search" action="search.html" data-uk-search>
            <input class="uk-search-field" type="search" name="q" id="tipue_search_input" autocomplete="off" placeholder="Search...">
        </form>

        <ul class="uk-nav uk-nav-offcanvas" data-uk-nav>
            <li class="uk-nav-header">Categories</li>
            <li ><a href="http://ptyagicodecamp.github.io/category/development.html">Development</a></li>
            <li class="uk-nav-header">Pages</li>        
                    

            <li class="uk-nav-divider"></li>
            <li><a href="http://ptyagicodecamp.github.io/">Archives</a></li>
        </ul>
    </div>
</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.10.2.min.js"><\/script>')</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/uikit/2.15.0/js/uikit.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/uikit/2.15.0/js/components/search.min.js"></script>
<script src="/theme/js/jquery.sticky-kit.js"></script>
<script src="/theme/js/tipuesearch_set.js"></script>
<script src="/theme/js/tipuesearch.js"></script>
<script src="/theme/js/plugins.js"></script>
<script src="/theme/js/main.js"></script>

<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = ''; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
 var s = document.createElement('script'); s.async = true;
 s.type = 'text/javascript';
 s.src = '//' + disqus_shortname + '.disqus.com/count.js';
 (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
 }());
</script>


</body>
</html>
