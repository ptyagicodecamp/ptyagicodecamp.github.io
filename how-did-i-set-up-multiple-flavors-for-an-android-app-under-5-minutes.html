<!DOCTYPE html>
<!--[if lt IE 7]>      <html lang="en" class="no-js lt-ie9 lt-ie8 lt-ie7" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/BlogPosting"> <![endif]-->
<!--[if IE 7]>         <html lang="en" class="no-js lt-ie9 lt-ie8" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/BlogPosting"> <![endif]-->
<!--[if IE 8]>         <html lang="en" class="no-js lt-ie9" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/BlogPosting"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="en" class="no-js" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/BlogPosting"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>How did I set up multiple flavors for an Android App under 5 minutes</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="This post is part of the "under 5 minutes series". In this post I'll talk about how did I set up flavors for an Android app.">
<link rel="shortcut icon" href="http://ptyagicodecamp.github.io/" type="">
<meta name="author" content="Priyanka Tyagi">
<meta name="copyright" content="Priyanka Tyagi">
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta property="og:site_name" content="techLog" />

<meta property="og:title" content="How did i set up multiple flavors for an android app under 5 minutes" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://ptyagicodecamp.github.io/how-did-i-set-up-multiple-flavors-for-an-android-app-under-5-minutes.html" />
<meta name="twitter:title" content="How did i set up multiple flavors for an android app under 5 minutes" />
<meta name="twitter:url" content="http://ptyagicodecamp.github.io/how-did-i-set-up-multiple-flavors-for-an-android-app-under-5-minutes.html" />
<meta itemprop="url" content="http://ptyagicodecamp.github.io/how-did-i-set-up-multiple-flavors-for-an-android-app-under-5-minutes.html" />
<meta property="og:description" content="This post is part of the &#34;under 5 minutes series&#34;. In this post I&#39;ll talk about how did I set up flavors for an Android app." />
<meta name="twitter:description" content="This post is part of the &#34;under 5 minutes series&#34;. In this post I&#39;ll talk about how did I set up flavors for an Android app." />
<meta property="og:article:published_time" content="2017-07-18" />
<meta property="og:article:author" content="ptyagi" >
<meta property="og:article:tag" content="android">
<meta property="og:article:tag" content="gradle">
<meta property="og:article:tag" content="flavors">
<meta property="og:article:tag" content="build-variants">
<meta property="og:article:tag" content="dev">
<meta property="og:article:tag" content="5-minutes-series">

<link href="http://ptyagicodecamp.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="techLog ATOM Feed"/>
<link href='//fonts.googleapis.com/css?family=Open+Sans:800italic' rel='stylesheet' type='text/css'>
<link href='//fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/uikit/2.15.0/css/uikit.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/uikit/2.15.0/css/components/search.min.css">
<link rel="stylesheet" href="/theme/css/tipuesearch.css">
<link rel="stylesheet" href="/theme/css/solarized.css">
<link rel="stylesheet" href="/theme/css/main.css">

<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
</head>
<body>
<!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

<header class=" mg-header uk-navbar uk-navbar-attached">

    <div class="uk-container uk-container-center">
        <div class="uk-grid" data-uk-grid-margin>

            <a class="mg-brand uk-navbar-brand uk-hidden-small" href="http://ptyagicodecamp.github.io">techLog</a>
            <div class="mg-tagline uk-navbar-content uk-hidden-small"></div>
            <a class="uk-navbar-toggle uk-visible-small" href="#mg-offcanvas" data-uk-offcanvas></a>
            <a class="mg-brand uk-navbar-brand uk-navbar-center uk-visible-small" href="http://ptyagicodecamp.github.io">techLog</a>

        </div>
    </div>
</header>

<main class="mg-main">

<div class="uk-container uk-container-center">

    <div class="uk-grid" data-uk-grid-margin>
        
<div class="mg-container-social uk-width-medium-1-10 uk-hidden-small">


</div>

<div class="uk-width-medium-7-10">

    <article class="uk-article">
        <h1 class="uk-heading-large uk-article-title" itemprop="name">How did I set up multiple flavors for an Android App under 5 minutes</h1>
        <p class="uk-article-meta"><time datetime="2017-07-18" itemprop="datePublished">Tue 18 July 2017</time> in <a href="http://ptyagicodecamp.github.io/category/development.html">Development</a></p>


        <p class="uk-article-lead" itemprop="description">This post is part of the "under 5 minutes series". In this post I'll talk about how did I set up flavors for an Android app.</p>
        <section itemprop="articleBody"><p>Let's start with understanding few key terms.</p>
<h2>Understanding differences between "Build Types", "Flavor" and "Build Variant"</h2>
<p>***Build Types:
Build Type refers to build and packaging settings like signing configuration for a project.</p>
<p>***Flavor:
A flavor is used to specify custom features, minimum and target API levels, device and API requirements like layout, drawable and custom code (for example, if production code is slightly different than development code).</p>
<p>***Build Variant:
The combination of Build Type and Flavor is known as Build Variant.</p>
<p>And, now time to dig deeper !</p>
<h2>Android Apps: Flavors</h2>
<h2>Motivation</h2>
<p>The motivation behind <strong><em>Android Flavors</em></strong> is <strong><em>code reuse</em></strong> and <strong><em>code maintainability</em></strong>.
Time to time, we might want to publish different versions of the same app with slight changes in
assets or functionality. For example, in free version of the app, you may want to show ads while in
paid version, you may decide not to show ads and integrate in-app purchase or upfront price rather.
That's where <strong><em>Android Flavors</em></strong> help us to achieve this flexibility.</p>
<h2>Setting up Flavors in <code>build.gradle</code></h2>
<div class="highlight"><pre><span></span>android {
    flavorDimensions &quot;version&quot;

    productFlavors {
        freeVersion {
            dimension &quot;version&quot;

        }

        paidVersion {
            dimension &quot;version&quot;
        }
    }
}
</pre></div>


<p>These newly created flavors appears in "Build Variants" tab of Android Studio:</p>
<p><img alt="Alt Build Variants" src="../images/flavors/build_variants_1.png"></p>
<p>Note 1: You'll have to choose the configuration from "Build Variants" drop down menu before runnind the app on device/emulator.</p>
<p>Note 2: <a href="https://developer.android.com/studio/build/gradle-plugin-3-0-0-migration.html?utm_source=android-studio#variant_aware">Starting Android Studion 3.0</a>,
 <code>flavorDimension</code> attribute needs to be added.</p>
<h2>Application Id</h2>
<p>Each flavor can have its own application Id. An 'applicationId' makes a app in Play Store unique.
In this example, the free version will be published on Play Store with packageId/applicationId as <code>com.pcc.flavors.free</code>
and paid one will have <code>com.pcc.flavors.paid</code>.</p>
<p>Note: I'll be showing <code>build.gradle</code> with all the configuration until this point.</p>
<div class="highlight"><pre><span></span>android {
    flavorDimensions &quot;version&quot;

    productFlavors {
        freeVersion {
            dimension &quot;version&quot;

            applicationId &quot;com.pcc.flavors.free&quot;

        }

        paidVersion {
            dimension &quot;version&quot;

            applicationId &quot;com.pcc.flavors.paid&quot;
        }
    }
}
</pre></div>


<h2>Configuring App's name</h2>
<p>Each flavor can have its own name as well. For example, free version has app name shown to users
in Play Store as "Free Great App" and paid version has its name displayed in Play Store as "Paid Great App".
Let's see how this can be configured in <code>build.gradle</code>.</p>
<div class="highlight"><pre><span></span>android {
    flavorDimensions &quot;version&quot;

    productFlavors {
        freeVersion {
            //select the dimension of flavor
            dimension &quot;version&quot;

            //configure applicationId for app published to Play store
            applicationId &quot;com.pcc.flavors.free&quot;

            //Configure this flavor specific app name published in Play Store
            resValue &quot;string&quot;, &quot;flavored_app_name&quot;, &quot;Free Great App&quot;

        }

        paidVersion {
            dimension &quot;version&quot;

            applicationId &quot;com.pcc.flavors.paid&quot;
            resValue &quot;string&quot;, &quot;flavored_app_name&quot;, &quot;Paid Great App&quot;
        }
    }
}
</pre></div>


<p>Don't forget to use <code>flavored_app_name</code> string resource from <code>AndroidManifest.xml</code> to defined app's name:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class="na">package=</span><span class="s">&quot;org.pcc.flavors&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;application</span>
        <span class="na">android:label=</span><span class="s">&quot;@string/flavored_app_name&quot;</span>
    <span class="err">&lt;/application</span><span class="nt">&gt;</span>

<span class="nt">&lt;/manifest&gt;</span>
</pre></div>


<h2>Flavor specific Icons for apps</h2>
<p>Each differently named/flavored app may want to have its own icon. Lets see how would we achieve this.
First we have to create a flavor specific directory at the same level of <code>main</code>. Basically, we need to mimic
the <code>main</code> directory for each flavor to support fully functional flavors (when there's code changes are involved).
These directories must be named same as its flavor definition names. In our example, these two additional
directories are : <code>freeVersion</code> and <code>paidVersion</code>.</p>
<p><img alt="Alt Flavored Icons" src="../images/flavors/flavored_icons.png"></p>
<p>Make sure that you've the icon's name same as referenced from <code>AndroidManifest.xml</code></p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class="na">package=</span><span class="s">&quot;org.pcc.flavors&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;application</span>

        <span class="na">android:icon=</span><span class="s">&quot;@mipmap/ic_launcher&quot;</span>

    <span class="err">&lt;/application</span><span class="nt">&gt;</span>

<span class="nt">&lt;/manifest&gt;</span>
</pre></div>


<h2>Finally, flavor some code !</h2>
<p>It's very similar to flavoring icons for specific app. Remember that you've the same directory/package
structure across all the flavors. That's how the changes are overridden.
For demonstration purposes, I'll update <code>TextView</code> widget text differently for each app. Free version's
<code>TextView</code> will read "Hello Free Great App !", and Paid version will read : "Hello Paid App !".
It involves two steps:
1. Make sure that you've the same code directory structure.
2. Write your custom code !</p>
<p>Note: There's one gotcha though. You can't have the same class defined in <code>src/main/java</code> and <code>src/&lt;flavorNmae&gt;/java</code> directories. Gradle will throw Duplicate class error while building. Either you can have one class in <code>src/main/java</code> or in other flavors. I've <code>MainActivity2</code> in <code>src/freeVersion/java</code> and <code>src/paidVersion/java</code>, but not in <code>src/main/java</code>. <code>AndroidManifest.xml</code> has reference to <code>MainActivity2</code>, so it picks <code>MainActivity2</code> for a selected build variant's flavor.</p>
<p>Project structure would look like this:
<img alt="Alt flavored code" src="../images/flavors/flavor_code.png"></p>
<p>Checkout the demo app in <a href="https://github.com/ptyagicodecamp/android-recipes/tree/develop/Flavors">Github</a></p>
<p>Checkout this article on <a href="https://ptyagicodecamp.github.io/how-did-i-set-up-multiple-flavors-for-an-android-app-under-5-minutes.html">my blog</a></p></section>
        <hr class="uk-article-divider">
    </article>


</div>
 
    
        <div class="uk-width-medium-1-5 uk-hidden-small">
            
            <div class="uk-panel uk-panel-box">
                <form class="uk-search" action="search.html" data-uk-search>
                    <input class="uk-search-field tipue_search" type="search" name="q" id="tipue_search_input" autocomplete="off" placeholder="Search...">
                </form>
            </div>

            <div class="uk-panel uk-panel-box">
                <ul class="uk-nav uk-nav-side">
                    <li class="uk-nav-header">Categories</li>
                    <li class="uk-active"><a href="http://ptyagicodecamp.github.io/category/development.html">Development</a></li>
                    <li class="uk-nav-header">Pages</li>
                    
                    

                    <li class="uk-nav-divider"></li>
                    <li ><a href="http://ptyagicodecamp.github.io/archives.html">Archives</a></li>
                </ul>
            </div>

            <div class="uk-panel uk-panel-box">
                <h3 class="uk-panel-title">Receive Updates</h3>
                <a rel="alternate" type="application/atom+xml" href="http://ptyagicodecamp.github.io/feeds/all.atom.xml" class="mg-feed"><i class="uk-icon-rss uk-icon-medium"></i> ATOM</a>
            </div>
            

        </div>

    </div>

</div>

</main>

<footer class="mg-footer">
    <div class="uk-container uk-container-center uk-text-center">

        <div class="mg-icons-small uk-subnav uk-visible-small">
            <li><a rel="alternate" type="application/atom+xml" href="http://ptyagicodecamp.github.io/feeds/all.atom.xml" class="uk-icon-button uk-icon-rss"></a></li>
        </div>

        <div class="mg-author uk-panel">
            <p></p>

            <p>Powered by <a href="http://blog.getpelican.com">Pelican</a>.<br class="uk-visible-small"> Theme <a href="https://github.com/lucachr/pelican-mg">mg</a> by <a href="https://github.com/lucachr">Luca Chiricozzi</a>.</p>
        </div>
    </div> 
</footer>

<div id="mg-offcanvas" class="uk-offcanvas">
    <div class="uk-offcanvas-bar">

        <form class="uk-search" action="search.html" data-uk-search>
            <input class="uk-search-field" type="search" name="q" id="tipue_search_input" autocomplete="off" placeholder="Search...">
        </form>

        <ul class="uk-nav uk-nav-offcanvas" data-uk-nav>
            <li class="uk-nav-header">Categories</li>
            <li class="uk-active"><a href="http://ptyagicodecamp.github.io/category/development.html">Development</a></li>
            <li class="uk-nav-header">Pages</li>        
                    

            <li class="uk-nav-divider"></li>
            <li><a href="http://ptyagicodecamp.github.io/">Archives</a></li>
        </ul>
    </div>
</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.10.2.min.js"><\/script>')</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/uikit/2.15.0/js/uikit.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/uikit/2.15.0/js/components/search.min.js"></script>
<script src="/theme/js/jquery.sticky-kit.js"></script>
<script src="/theme/js/tipuesearch_set.js"></script>
<script src="/theme/js/tipuesearch.js"></script>
<script src="/theme/js/plugins.js"></script>
<script src="/theme/js/main.js"></script>

<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = ''; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
 var s = document.createElement('script'); s.async = true;
 s.type = 'text/javascript';
 s.src = '//' + disqus_shortname + '.disqus.com/count.js';
 (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
 }());
</script>


</body>
</html>
