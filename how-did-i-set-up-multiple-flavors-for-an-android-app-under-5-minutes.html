<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="This post is part of the &#34;under 5 minutes series&#34;. In this post I&#39;ll talk about how did I set up flavors for an Android app." />

    <meta name="author" content="ptyagi" />
    <meta name="copyright" content="ptyagi" />


        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<title>How did I set up multiple flavors for an Android App under 5 minutes - </title>

    <!-- iPython Notebook script -->
    <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
            <script type="text/javascript">
            init_mathjax = function() {
                if (window.MathJax) {
                    // MathJax loaded
                    MathJax.Hub.Config({
                        tex2jax: {
                            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                            displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
                        },
                        displayAlign: 'left', // Change this to 'center' to center equations.
                        "HTML-CSS": {
                            styles: {'.MathJax_Display': {"margin": 0}}
                        }
                    });
                    MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
                }
            }
            init_mathjax();
        </script>
      <!--Import jQuery before materialize.js-->
      <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>

      <!-- iPython Notebook script for collapsing and expanding code -->
        <script type="text/javascript">
        jQuery(document).ready(function($) {
            $("div.collapseheader").click(function () {
            $header = $(this).children("span").first();
            $codearea = $(this).children(".input_area");
            console.log($(this).children());
            $codearea.slideToggle(500, function () {
                $header.text(function () {
                    return $codearea.is(":visible") ? "Collapse Code" : "Expand Code";
                });
            });
        });
        });
        </script>
        <script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        </script>
    <!-- Bootstrap Core CSS -->
    <link href="/theme/css/bootstrap.min.css" rel="stylesheet">

         <!-- Compiled and minified CSS -->
     <link rel="stylesheet" href="/theme/css/materialize.min.css">

     <!-- Compiled and minified JavaScript -->
     <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.0/js/materialize.min.js"></script>

    <!-- Custom Fonts -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">

    <link href="http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="/theme/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Arvo" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Permanent+Marker|Pacifico|Nova+Round|EB+Garamond|Kaushan+Script' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Lobster+Two' rel='stylesheet' type='text/css'>
    <!-- Custom CSS -->
    <link href="/theme/css/pelican-smoothie.css" rel="stylesheet">
    <link href="/theme/css/pygment.css" rel="stylesheet">
    <link rel="stylesheet" href="/theme/tipuesearch/tipuesearch.css">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


<script>
    mixpanel.track("Page", {"Name": "How did I set up multiple flavors for an Android App under 5 minutes", "url": "how-did-i-set-up-multiple-flavors-for-an-android-app-under-5-minutes.html"  }) ;
</script>
</head>

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">

   <div class="search-button">
            <form id="search" class="floating-search" action="/search.html" onsubmit="return validateForm(this.elements['q'].value);">
            <input type="search" class="search-query" placeholder="Search" name="q"></form>
       </div>




    <div class="content-block">

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header class="intro-header-article" style="background-image: url('');">
        <div class="intro-body">
            <div class="container">
                <div class="row">
                    <div class="col-sm-2 fixed-action-btn">
                    <a href='/blog' class="btn-floating btn-large white page-scroll">
                      <i class="md-dark material-icons">keyboard_arrow_left</i>
                    </a>
                    </div>
                    <div class="col-sm-10 col-sm-offset-1">
                    <h1 class="article-heading">How did I set up multiple flavors for an Android App under 5 minutes</h1>
                        <h2 class="article-subheading"> </h2>
<span class="meta last-updated">
Published on 
<time pubdate="pubdate" datetime="2017-07-18T15:50:00-06:00">Jul 18, 2017</time>
</span>                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Post Content -->
    <article>
        <div class="container">
            <div class="row">
                <div class="col-lg-10 col-lg-offset-1">
                    <div class="entry-content">
                    <p>Let's start with understanding few key terms.</p>
<h2>Understanding differences between "Build Types", "Flavor" and "Build Variant"</h2>
<p>***Build Types:
Build Type refers to build and packaging settings like signing configuration for a project.</p>
<p>***Flavor:
A flavor is used to specify custom features, minimum and target API levels, device and API requirements like layout, drawable and custom code (for example, if production code is slightly different than development code).</p>
<p>***Build Variant:
The combination of Build Type and Flavor is known as Build Variant.</p>
<p>And, now time to dig deeper !</p>
<h2>Android Apps: Flavors</h2>
<h2>Motivation</h2>
<p>The motivation behind <strong><em>Android Flavors</em></strong> is <strong><em>code reuse</em></strong> and <strong><em>code maintainability</em></strong>.
Time to time, we might want to publish different versions of the same app with slight changes in
assets or functionality. For example, in free version of the app, you may want to show ads while in
paid version, you may decide not to show ads and integrate in-app purchase or upfront price rather.
That's where <strong><em>Android Flavors</em></strong> help us to achieve this flexibility.</p>
<h2>Setting up Flavors in <code>build.gradle</code></h2>
<div class="highlight"><pre><span></span>android {
    flavorDimensions &quot;version&quot;

    productFlavors {
        freeVersion {
            dimension &quot;version&quot;

        }

        paidVersion {
            dimension &quot;version&quot;
        }
    }
}
</pre></div>


<p>These newly created flavors appears in "Build Variants" tab of Android Studio:</p>
<p><img alt="Alt Build Variants" src="../images/flavors/build_variants_1.png"></p>
<p>Note 1: You'll have to choose the configuration from "Build Variants" drop down menu before runnind the app on device/emulator.</p>
<p>Note 2: <a href="https://developer.android.com/studio/build/gradle-plugin-3-0-0-migration.html?utm_source=android-studio#variant_aware">Starting Android Studion 3.0</a>,
 <code>flavorDimension</code> attribute needs to be added.</p>
<h2>Application Id</h2>
<p>Each flavor can have its own application Id. An 'applicationId' makes a app in Play Store unique.
In this example, the free version will be published on Play Store with packageId/applicationId as <code>com.pcc.flavors.free</code>
and paid one will have <code>com.pcc.flavors.paid</code>.</p>
<p>Note: I'll be showing <code>build.gradle</code> with all the configuration until this point.</p>
<div class="highlight"><pre><span></span>android {
    flavorDimensions &quot;version&quot;

    productFlavors {
        freeVersion {
            dimension &quot;version&quot;

            applicationId &quot;com.pcc.flavors.free&quot;

        }

        paidVersion {
            dimension &quot;version&quot;

            applicationId &quot;com.pcc.flavors.paid&quot;
        }
    }
}
</pre></div>


<h2>Configuring App's name</h2>
<p>Each flavor can have its own name as well. For example, free version has app name shown to users
in Play Store as "Free Great App" and paid version has its name displayed in Play Store as "Paid Great App".
Let's see how this can be configured in <code>build.gradle</code>.</p>
<div class="highlight"><pre><span></span>android {
    flavorDimensions &quot;version&quot;

    productFlavors {
        freeVersion {
            //select the dimension of flavor
            dimension &quot;version&quot;

            //configure applicationId for app published to Play store
            applicationId &quot;com.pcc.flavors.free&quot;

            //Configure this flavor specific app name published in Play Store
            resValue &quot;string&quot;, &quot;flavored_app_name&quot;, &quot;Free Great App&quot;

        }

        paidVersion {
            dimension &quot;version&quot;

            applicationId &quot;com.pcc.flavors.paid&quot;
            resValue &quot;string&quot;, &quot;flavored_app_name&quot;, &quot;Paid Great App&quot;
        }
    }
}
</pre></div>


<p>Don't forget to use <code>flavored_app_name</code> string resource from <code>AndroidManifest.xml</code> to defined app's name:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class="na">package=</span><span class="s">&quot;org.pcc.flavors&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;application</span>
        <span class="na">android:label=</span><span class="s">&quot;@string/flavored_app_name&quot;</span>
    <span class="err">&lt;/application</span><span class="nt">&gt;</span>

<span class="nt">&lt;/manifest&gt;</span>
</pre></div>


<h2>Flavor specific Icons for apps</h2>
<p>Each differently named/flavored app may want to have its own icon. Lets see how would we achieve this.
First we have to create a flavor specific directory at the same level of <code>main</code>. Basically, we need to mimic
the <code>main</code> directory for each flavor to support fully functional flavors (when there's code changes are involved).
These directories must be named same as its flavor definition names. In our example, these two additional
directories are : <code>freeVersion</code> and <code>paidVersion</code>.</p>
<p><img alt="Alt Flavored Icons" src="../images/flavors/flavored_icons.png"></p>
<p>Make sure that you've the icon's name same as referenced from <code>AndroidManifest.xml</code></p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class="na">package=</span><span class="s">&quot;org.pcc.flavors&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;application</span>

        <span class="na">android:icon=</span><span class="s">&quot;@mipmap/ic_launcher&quot;</span>

    <span class="err">&lt;/application</span><span class="nt">&gt;</span>

<span class="nt">&lt;/manifest&gt;</span>
</pre></div>


<h2>Finally, flavor some code !</h2>
<p>It's very similar to flavoring icons for specific app. Remember that you've the same directory/package
structure across all the flavors. That's how the changes are overridden.
For demonstration purposes, I'll update <code>TextView</code> widget text differently for each app. Free version's
<code>TextView</code> will read "Hello Free Great App !", and Paid version will read : "Hello Paid App !".
It involves two steps:
1. Make sure that you've the same code directory structure.
2. Write your custom code !</p>
<p>Note: There's one gotcha though. You can't have the same class defined in <code>src/main/java</code> and <code>src/&lt;flavorNmae&gt;/java</code> directories. Gradle will throw Duplicate class error while building. Either you can have one class in <code>src/main/java</code> or in other flavors. I've <code>MainActivity2</code> in <code>src/freeVersion/java</code> and <code>src/paidVersion/java</code>, but not in <code>src/main/java</code>. <code>AndroidManifest.xml</code> has reference to <code>MainActivity2</code>, so it picks <code>MainActivity2</code> for a selected build variant's flavor.</p>
<p>Project structure would look like this:
<img alt="Alt flavored code" src="../images/flavors/flavor_code.png"></p>
<p>Checkout the demo app in <a href="https://github.com/ptyagicodecamp/android-recipes/tree/develop/Flavors">Github</a></p>
<p>Checkout this article on <a href="https://ptyagicodecamp.github.io/how-did-i-set-up-multiple-flavors-for-an-android-app-under-5-minutes.html">my blog</a></p>
                    </div>
                </div>
            </div>
        </div>
    </article>

    <hr>

    </div>

    <!-- Footer -->
    <footer>
    <div id="footer" class="container text-center">
            </div>
    </footer>

    <!-- jQuery -->
    <script src="/theme/js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="/theme/js/bootstrap.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="/theme/js/jquery.easing.min.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="/theme/js/pelican-smoothie.js"></script>
    <script type="text/javascript" src="/theme/tipuesearch/tipuesearch_set.js"></script>
    <script type="text/javascript" src="/theme/tipuesearch/tipuesearch.min.js"></script>
    <script>
    // jQuery to change FAB
    $(window).scroll(function() {
            var scroll = $(window).scrollTop();
          if (scroll > window.innerHeight/6 ) {
            $(".fixed-action-btn").addClass("scrolled");
            $(".fixed-action-btn a.btn-large").attr("href", "#page-top")
            $('.fixed-action-btn .btn-large .material-icons').text('keyboard_arrow_up');
            $('.fixed-action-btn .btn-large').addClass('customcolor');
            $('.fixed-action-btn .btn-large').removeClass('white');
            $('.fixed-action-btn a.btn-large i').addClass('md-light');
            $('.fixed-action-btn a.btn-large i').removeClass('md-dark');
        }
          if (scroll > 200 ) {
            $(".fixed-action-btn").addClass("scrolled");
            $(".fixed-action-btn a.btn-large").attr("href", "#page-top")
            $('.fixed-action-btn .btn-large .material-icons').text('keyboard_arrow_up');
            $('.fixed-action-btn .btn-large').addClass('customcolor');
            $('.fixed-action-btn .btn-large').removeClass('white');
            $('.fixed-action-btn a.btn-large i').addClass('md-light');
            $('.fixed-action-btn a.btn-large i').removeClass('md-dark');
        }
          if (scroll < window.innerHeight/6 ) {
            $(".fixed-action-btn").removeClass("scrolled");
            $(".fixed-action-btn a.btn-large").attr("href", "/blog")
            $('.fixed-action-btn .btn-large .material-icons').text('keyboard_arrow_left');
            $('.fixed-action-btn .btn-large').removeClass('customcolor');
            $('.fixed-action-btn .btn-large').addClass('white');
            $('.fixed-action-btn a.btn-large i').removeClass('md-light');
            $('.fixed-action-btn a.btn-large i').addClass('md-dark');
        }
    });
    </script>

</body>
</html>
