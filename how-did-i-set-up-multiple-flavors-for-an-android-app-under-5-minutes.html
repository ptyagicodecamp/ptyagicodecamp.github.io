<!DOCTYPE html>
<html lang="en">
<head>
          <title>techLog - How did I set up multiple flavors for an Android App under 5 minutes</title>
        <meta charset="utf-8" />




    <meta name="tags" content="android" />
    <meta name="tags" content="gradle" />
    <meta name="tags" content="flavors" />
    <meta name="tags" content="build-variants" />
    <meta name="tags" content="dev" />
    <meta name="tags" content="5-minutes-series" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">techLog <strong></strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li class="active"><a href="/category/development.html">Development</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="/how-did-i-set-up-multiple-flavors-for-an-android-app-under-5-minutes.html" rel="bookmark"
         title="Permalink to How did I set up multiple flavors for an Android App under 5 minutes">How did I set up multiple flavors for an Android App under 5 minutes</a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2017-07-18T15:50:00-06:00">
      Tue 18 July 2017
    </time>
    <address class="vcard author">
      By           <a class="url fn" href="/author/ptyagi.html">ptyagi</a>
    </address>
    <div class="category">
        Category: <a href="/category/development.html">Development</a>
    </div>
    <div class="tags">
        Tags:
            <a href="/tag/android.html">android</a>
            <a href="/tag/gradle.html">gradle</a>
            <a href="/tag/flavors.html">flavors</a>
            <a href="/tag/build-variants.html">build-variants</a>
            <a href="/tag/dev.html">dev</a>
            <a href="/tag/5-minutes-series.html">5-minutes-series</a>
    </div>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>Let's start with understanding few key terms.</p>
<h2>Understanding differences between "Build Types", "Flavor" and "Build Variant"</h2>
<p>***Build Types:
Build Type refers to build and packaging settings like signing configuration for a project.</p>
<p>***Flavor:
A flavor is used to specify custom features, minimum and target API levels, device and API requirements like layout, drawable and custom code (for example, if production code is slightly different than development code).</p>
<p>***Build Variant:
The combination of Build Type and Flavor is known as Build Variant.</p>
<p>And, now time to dig deeper !</p>
<h2>Android Apps: Flavors</h2>
<h2>Motivation</h2>
<p>The motivation behind <strong><em>Android Flavors</em></strong> is <strong><em>code reuse</em></strong> and <strong><em>code maintainability</em></strong>.
Time to time, we might want to publish different versions of the same app with slight changes in
assets or functionality. For example, in free version of the app, you may want to show ads while in
paid version, you may decide not to show ads and integrate in-app purchase or upfront price rather.
That's where <strong><em>Android Flavors</em></strong> help us to achieve this flexibility.</p>
<h2>Setting up Flavors in <code>build.gradle</code></h2>
<div class="highlight"><pre><span></span>android {
    flavorDimensions &quot;version&quot;

    productFlavors {
        freeVersion {
            dimension &quot;version&quot;

        }

        paidVersion {
            dimension &quot;version&quot;
        }
    }
}
</pre></div>


<p>These newly created flavors appears in "Build Variants" tab of Android Studio:</p>
<p><img alt="Alt Build Variants" src="../images/flavors/build_variants_1.png"></p>
<p>Note 1: You'll have to choose the configuration from "Build Variants" drop down menu before runnind the app on device/emulator.</p>
<p>Note 2: <a href="https://developer.android.com/studio/build/gradle-plugin-3-0-0-migration.html?utm_source=android-studio#variant_aware">Starting Android Studion 3.0</a>,
 <code>flavorDimension</code> attribute needs to be added.</p>
<h2>Application Id</h2>
<p>Each flavor can have its own application Id. An 'applicationId' makes a app in Play Store unique.
In this example, the free version will be published on Play Store with packageId/applicationId as <code>com.pcc.flavors.free</code>
and paid one will have <code>com.pcc.flavors.paid</code>.</p>
<p>Note: I'll be showing <code>build.gradle</code> with all the configuration until this point.</p>
<div class="highlight"><pre><span></span>android {
    flavorDimensions &quot;version&quot;

    productFlavors {
        freeVersion {
            dimension &quot;version&quot;

            applicationId &quot;com.pcc.flavors.free&quot;

        }

        paidVersion {
            dimension &quot;version&quot;

            applicationId &quot;com.pcc.flavors.paid&quot;
        }
    }
}
</pre></div>


<h2>Configuring App's name</h2>
<p>Each flavor can have its own name as well. For example, free version has app name shown to users
in Play Store as "Free Great App" and paid version has its name displayed in Play Store as "Paid Great App".
Let's see how this can be configured in <code>build.gradle</code>.</p>
<div class="highlight"><pre><span></span>android {
    flavorDimensions &quot;version&quot;

    productFlavors {
        freeVersion {
            //select the dimension of flavor
            dimension &quot;version&quot;

            //configure applicationId for app published to Play store
            applicationId &quot;com.pcc.flavors.free&quot;

            //Configure this flavor specific app name published in Play Store
            resValue &quot;string&quot;, &quot;flavored_app_name&quot;, &quot;Free Great App&quot;

        }

        paidVersion {
            dimension &quot;version&quot;

            applicationId &quot;com.pcc.flavors.paid&quot;
            resValue &quot;string&quot;, &quot;flavored_app_name&quot;, &quot;Paid Great App&quot;
        }
    }
}
</pre></div>


<p>Don't forget to use <code>flavored_app_name</code> string resource from <code>AndroidManifest.xml</code> to defined app's name:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class="na">package=</span><span class="s">&quot;org.pcc.flavors&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;application</span>
        <span class="na">android:label=</span><span class="s">&quot;@string/flavored_app_name&quot;</span>
    <span class="err">&lt;/application</span><span class="nt">&gt;</span>

<span class="nt">&lt;/manifest&gt;</span>
</pre></div>


<h2>Flavor specific Icons for apps</h2>
<p>Each differently named/flavored app may want to have its own icon. Lets see how would we achieve this.
First we have to create a flavor specific directory at the same level of <code>main</code>. Basically, we need to mimic
the <code>main</code> directory for each flavor to support fully functional flavors (when there's code changes are involved).
These directories must be named same as its flavor definition names. In our example, these two additional
directories are : <code>freeVersion</code> and <code>paidVersion</code>.</p>
<p><img alt="Alt Flavored Icons" src="../images/flavors/flavored_icons.png"></p>
<p>Make sure that you've the icon's name same as referenced from <code>AndroidManifest.xml</code></p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class="na">package=</span><span class="s">&quot;org.pcc.flavors&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;application</span>

        <span class="na">android:icon=</span><span class="s">&quot;@mipmap/ic_launcher&quot;</span>

    <span class="err">&lt;/application</span><span class="nt">&gt;</span>

<span class="nt">&lt;/manifest&gt;</span>
</pre></div>


<h2>Finally, flavor some code !</h2>
<p>It's very similar to flavoring icons for specific app. Remember that you've the same directory/package
structure across all the flavors. That's how the changes are overridden.
For demonstration purposes, I'll update <code>TextView</code> widget text differently for each app. Free version's
<code>TextView</code> will read "Hello Free Great App !", and Paid version will read : "Hello Paid App !".
It involves two steps:
1. Make sure that you've the same code directory structure.
2. Write your custom code !</p>
<p>Note: There's one gotcha though. You can't have the same class defined in <code>src/main/java</code> and <code>src/&lt;flavorNmae&gt;/java</code> directories. Gradle will throw Duplicate class error while building. Either you can have one class in <code>src/main/java</code> or in other flavors. I've <code>MainActivity2</code> in <code>src/freeVersion/java</code> and <code>src/paidVersion/java</code>, but not in <code>src/main/java</code>. <code>AndroidManifest.xml</code> has reference to <code>MainActivity2</code>, so it picks <code>MainActivity2</code> for a selected build variant's flavor.</p>
<p>Project structure would look like this:
<img alt="Alt flavored code" src="../images/flavors/flavor_code.png"></p>
<p>Checkout the demo app in <a href="https://github.com/ptyagicodecamp/android-recipes/tree/develop/Flavors">Github</a></p>
<p>Checkout this article on <a href="https://ptyagicodecamp.github.io/how-did-i-set-up-multiple-flavors-for-an-android-app-under-5-minutes.html">my blog</a></p>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>