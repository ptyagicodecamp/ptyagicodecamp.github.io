
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://ptyagicodecamp.github.io/theme/stylesheet/style.min.css">


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="https://ptyagicodecamp.github.io/theme/pygments/monokai.min.css">


  <link rel="stylesheet" type="text/css" href="https://ptyagicodecamp.github.io/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://ptyagicodecamp.github.io/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://ptyagicodecamp.github.io/theme/font-awesome/css/solid.css">

    <link href="https://ptyagicodecamp.github.io/static/custom.css" rel="stylesheet">

    <link href="https://ptyagicodecamp.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="tech&Life Atom">


    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-133714063-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->
    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333333">

<meta name="author" content="ptyagi" />
<meta name="description" content="Introduction to scheduling repeating local notification in Android using AlarmManager." />
<meta name="keywords" content="Android, Notifications, AlarmManager">


<meta property="og:site_name" content="tech&Life"/>
<meta property="og:title" content="Scheduling Repeating Local Notifications using Alarm Manager"/>
<meta property="og:description" content="Introduction to scheduling repeating local notification in Android using AlarmManager."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://ptyagicodecamp.github.io/scheduling-repeating-local-notifications-using-alarm-manager.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2017-04-18 15:33:00-04:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://ptyagicodecamp.github.io/author/ptyagi.html">
<meta property="article:section" content="Development"/>
<meta property="article:tag" content="Android"/>
<meta property="article:tag" content="Notifications"/>
<meta property="article:tag" content="AlarmManager"/>
<meta property="og:image" content="https://ptyagicodecamp.github.io/images/profile.jpg">

  <title>tech&Life &ndash; Scheduling Repeating Local Notifications using Alarm Manager</title>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6359982310050489",
      enable_page_level_ads: true
    });
  </script>
</head>
<body class="light-theme">
  <aside>
    <div>
      <a href="https://ptyagicodecamp.github.io">
        <img src="https://ptyagicodecamp.github.io/images/profile.jpg" alt="tech&Life" title="tech&Life">
      </a>

      <h1>
        <a href="https://ptyagicodecamp.github.io">tech&Life</a>
      </h1>

<p>Explore | Life | Mobile | Software Engineering</p>

      <nav>
        <ul class="list">



            <li>
              <a target="_self" href="https://www.paypal.me/pritya" >Support</a>
            </li>
            <li>
              <a target="_self" href="https://www.codementor.io/ptyagicodecamp" >Codementor</a>
            </li>
        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-linkedin" href="https://www.linkedin.com/in/priyankatyagi" target="_blank">
              <i class="fab fa-linkedin"></i>
            </a>
          </li>
          <li>
            <a  class="sc-github" href="https://github.com/ptyagicodecamp" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-medium" href="https://medium.com/@ptyagicodecamp" target="_blank">
              <i class="fab fa-medium"></i>
            </a>
          </li>
          <li>
            <a  class="sc-twitter" href="https://twitter.com/ptyagi13" target="_blank">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
          <li>
            <a  class="sc-youtube" href="https://www.youtube.com/channel/UCO3_dbHasEnA2dr_U0EhMAA?view_as=subscriber" target="_blank">
              <i class="fab fa-youtube"></i>
            </a>
          </li>
          <li>
            <a  class="sc-codementor" href="https://www.codementor.io/ptyagicodecamp" target="_blank">
              <i class="fab fa-codementor"></i>
            </a>
          </li>
      </ul>
    </div>

      <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      <ins class="adsbygoogle ads-aside"
           data-ad-client="ca-pub-6359982310050489"
           data-ad-slot="8977779775"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
  </aside>
  <main>

    <nav>
      <a href="https://ptyagicodecamp.github.io">Home</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="https://ptyagicodecamp.github.io/feeds/all.atom.xml">Atom</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="scheduling-repeating-local-notifications-using-alarm-manager">Scheduling Repeating Local Notifications using Alarm Manager</h1>
    <p>
      Posted on April 18, 2017 in <a href="https://ptyagicodecamp.github.io/category/development.html">Development</a>

    </p>
  </header>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle ads-responsive"
         data-ad-client="ca-pub-6359982310050489"
         data-ad-slot="6546879945"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

  <div>
    <h2>Introduction</h2>
<p>This tutorial is a quick start guide to get you started with
Local Notifications in Android.</p>
<h3>Scheduling Repeating Local Notifications using Alarm Manager</h3>
<p>I'll be using Alarm Manager to schedule repeating local notifications in this sample app.
This sample app will send a local notification every morning at 8am.
I'm covering the use case that app is either in background or killed at the time when notification is received.
When user clicks on the notification, it takes user to app's main activity.</p>
<h4>Give user option to enable/disable notifications</h4>
<p>It's very important to give user option to opt-out or opt-in for local notifications.
You may want to do this in Settings Activity. When user has opted-in for local notifications,
then AlarmManager starts sending local notifications to user every morning. Time to send notifications
can be configured or just be default. I'll be using a default of 8am in this demo.</p>
<h3>Components</h3>
<h4>Scheduling notifications using Alarm Manager</h4>
<p>There're two types of Alarms can be scheduled:
- Wall clock time
- Elapsed time (since device is booted).
Read more about them <a href="https://developer.android.com/training/scheduling/alarms.html#set">here</a>
I'll be scheduling notifications using both kind of alarms.</p>
<p><strong><em>Scheduling RTC</em></strong></p>
<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * This is the real time /wall clock time</span>
<span class="cm"> * @param context</span>
<span class="cm"> */</span><span class="w"></span>
<span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">scheduleRepeatingRTCNotification</span><span class="p">(</span><span class="n">Context</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="k">hour</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">min</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="w">    </span><span class="o">//</span><span class="k">get</span><span class="w"> </span><span class="n">calendar</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="n">notification</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scheduled</span><span class="w"></span>
<span class="w">    </span><span class="n">Calendar</span><span class="w"> </span><span class="n">calendar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Calendar</span><span class="p">.</span><span class="n">getInstance</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">calendar</span><span class="p">.</span><span class="n">setTimeInMillis</span><span class="p">(</span><span class="k">System</span><span class="p">.</span><span class="n">currentTimeMillis</span><span class="p">());</span><span class="w"></span>
<span class="w">    </span><span class="o">//</span><span class="n">Setting</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nf">day</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="n">am</span><span class="w"> </span><span class="n">here</span><span class="p">)</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">notification</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="k">every</span><span class="w"> </span><span class="nf">day</span><span class="w"> </span><span class="p">(</span><span class="k">default</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">calendar</span><span class="p">.</span><span class="k">set</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="n">HOUR_OF_DAY</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="k">Integer</span><span class="p">.</span><span class="n">getInteger</span><span class="p">(</span><span class="k">hour</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">),</span><span class="w"></span>
<span class="w">            </span><span class="k">Integer</span><span class="p">.</span><span class="n">getInteger</span><span class="p">(</span><span class="nf">min</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">));</span><span class="w"></span>

<span class="w">    </span><span class="o">//</span><span class="n">Setting</span><span class="w"> </span><span class="n">intent</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">Alarm</span><span class="w"> </span><span class="n">broadcast</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">handled</span><span class="w"></span>
<span class="w">    </span><span class="n">Intent</span><span class="w"> </span><span class="n">intent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Intent</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">AlarmReceiver</span><span class="p">.</span><span class="k">class</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="o">//</span><span class="n">Setting</span><span class="w"> </span><span class="n">alarm</span><span class="w"> </span><span class="n">pending</span><span class="w"> </span><span class="n">intent</span><span class="w"></span>
<span class="w">    </span><span class="n">alarmIntentRTC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PendingIntent</span><span class="p">.</span><span class="n">getBroadcast</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">ALARM_TYPE_RTC</span><span class="p">,</span><span class="w"> </span><span class="n">intent</span><span class="p">,</span><span class="w"> </span><span class="n">PendingIntent</span><span class="p">.</span><span class="n">FLAG_UPDATE_CURRENT</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="o">//</span><span class="n">getting</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">AlarmManager</span><span class="w"> </span><span class="n">service</span><span class="w"></span>
<span class="w">    </span><span class="n">alarmManagerRTC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">AlarmManager</span><span class="p">)</span><span class="n">context</span><span class="p">.</span><span class="n">getSystemService</span><span class="p">(</span><span class="n">ALARM_SERVICE</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="o">//</span><span class="n">Setting</span><span class="w"> </span><span class="n">alarm</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">wake</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="k">every</span><span class="w"> </span><span class="nf">day</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">clock</span><span class="w"> </span><span class="nc">time</span><span class="p">.</span><span class="w"></span>
<span class="w">    </span><span class="o">//</span><span class="n">AlarmManager</span><span class="p">.</span><span class="n">RTC_WAKEUP</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">responsible</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">wake</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">sure</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">good</span><span class="w"> </span><span class="n">practice</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">time</span><span class="p">.</span><span class="w"></span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="k">Use</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">know</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">you</span><span class="s1">&#39;re doing.</span>
<span class="s1">    //Use RTC when you don&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">wake</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">device</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">deliver</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">notification</span><span class="w"> </span><span class="k">whenever</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">woke</span><span class="o">-</span><span class="n">up</span><span class="w"></span>
<span class="w">    </span><span class="o">//</span><span class="n">We</span><span class="err">&#39;</span><span class="n">ll</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">RTC</span><span class="p">.</span><span class="n">WAKEUP</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">demo</span><span class="w"> </span><span class="n">purpose</span><span class="w"> </span><span class="k">only</span><span class="w"></span>
<span class="w">    </span><span class="n">alarmManagerRTC</span><span class="p">.</span><span class="n">setInexactRepeating</span><span class="p">(</span><span class="n">AlarmManager</span><span class="p">.</span><span class="n">RTC_WAKEUP</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">calendar</span><span class="p">.</span><span class="n">getTimeInMillis</span><span class="p">(),</span><span class="w"> </span><span class="n">AlarmManager</span><span class="p">.</span><span class="n">INTERVAL_DAY</span><span class="p">,</span><span class="w"> </span><span class="n">alarmIntentRTC</span><span class="p">);</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>
</code></pre></div>

<p><strong><em>Scheduling Elapsed</em></strong></p>
<div class="highlight"><pre><span></span><code><span class="cm">/***</span>
<span class="cm"> * This is another way to schedule notifications using the elapsed time.</span>
<span class="cm"> * Its based on the relative time since device was booted up.</span>
<span class="cm"> * @param context</span>
<span class="cm"> */</span><span class="w"></span>
<span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">scheduleRepeatingElapsedNotification</span><span class="p">(</span><span class="n">Context</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="w">    </span><span class="o">//</span><span class="n">Setting</span><span class="w"> </span><span class="n">intent</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">notification</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">handled</span><span class="w"></span>
<span class="w">    </span><span class="n">Intent</span><span class="w"> </span><span class="n">intent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Intent</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">AlarmReceiver</span><span class="p">.</span><span class="k">class</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="o">//</span><span class="n">Setting</span><span class="w"> </span><span class="n">pending</span><span class="w"> </span><span class="n">intent</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">respond</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">broadcast</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">AlarmManager</span><span class="w"> </span><span class="n">everyday</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="mi">8</span><span class="n">am</span><span class="w"></span>
<span class="w">    </span><span class="n">alarmIntentElapsed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PendingIntent</span><span class="p">.</span><span class="n">getBroadcast</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">ALARM_TYPE_ELAPSED</span><span class="p">,</span><span class="w"> </span><span class="n">intent</span><span class="p">,</span><span class="w"> </span><span class="n">PendingIntent</span><span class="p">.</span><span class="n">FLAG_UPDATE_CURRENT</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="o">//</span><span class="n">getting</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">AlarmManager</span><span class="w"> </span><span class="n">service</span><span class="w"></span>
<span class="w">    </span><span class="n">alarmManagerElapsed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">AlarmManager</span><span class="p">)</span><span class="n">context</span><span class="p">.</span><span class="n">getSystemService</span><span class="p">(</span><span class="n">ALARM_SERVICE</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="o">//</span><span class="n">Inexact</span><span class="w"> </span><span class="n">alarm</span><span class="w"> </span><span class="n">everyday</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">booted</span><span class="w"> </span><span class="n">up</span><span class="p">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">better</span><span class="w"> </span><span class="n">choice</span><span class="w"> </span><span class="ow">and</span><span class="w"></span>
<span class="w">    </span><span class="o">//</span><span class="n">scales</span><span class="w"> </span><span class="n">well</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="n">settings</span><span class="o">/</span><span class="n">locale</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">changed</span><span class="w"></span>
<span class="w">    </span><span class="o">//</span><span class="n">We</span><span class="err">&#39;</span><span class="n">re</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">alarm</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">fire</span><span class="w"> </span><span class="n">notification</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="n">minutes</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">every</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="n">minutes</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="k">on</span><span class="w"></span>
<span class="w">    </span><span class="n">alarmManagerElapsed</span><span class="p">.</span><span class="n">setInexactRepeating</span><span class="p">(</span><span class="n">AlarmManager</span><span class="p">.</span><span class="n">ELAPSED_REALTIME</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">SystemClock</span><span class="p">.</span><span class="n">elapsedRealtime</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">AlarmManager</span><span class="p">.</span><span class="n">INTERVAL_FIFTEEN_MINUTES</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">AlarmManager</span><span class="p">.</span><span class="n">INTERVAL_FIFTEEN_MINUTES</span><span class="p">,</span><span class="w"> </span><span class="n">alarmIntentElapsed</span><span class="p">);</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>
</code></pre></div>

<h4>AlarmReceiver (BroadcastReceiver)</h4>
<p><code>AlarmReceiver</code> class extends <code>BroadcastReceiver</code>. This handles the AlarmManager's broadcast
 about sending local notifications at a given time.</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="n">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">AlarmReceiver</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">BroadcastReceiver</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="err">@</span><span class="n">Override</span><span class="w"></span>
<span class="w">     </span><span class="n">public</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">onReceive</span><span class="p">(</span><span class="n">Context</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">Intent</span><span class="w"> </span><span class="n">intent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">         </span><span class="o">//</span><span class="n">Intent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">invoke</span><span class="w"> </span><span class="n">app</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">click</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">notification</span><span class="o">.</span><span class="w"></span>
<span class="w">         </span><span class="o">//</span><span class="n">In</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">sample</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">start</span><span class="o">/</span><span class="n">launch</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">sample</span><span class="w"> </span><span class="n">app</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">clicks</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">notification</span><span class="w"></span>
<span class="w">         </span><span class="n">Intent</span><span class="w"> </span><span class="n">intentToRepeat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Intent</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">MainActivity</span><span class="o">.</span><span class="k">class</span><span class="p">);</span><span class="w"></span>
<span class="w">         </span><span class="o">//</span><span class="n">set</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">restart</span><span class="o">/</span><span class="n">relaunch</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">app</span><span class="w"></span>
<span class="w">         </span><span class="n">intentToRepeat</span><span class="o">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">Intent</span><span class="o">.</span><span class="n">FLAG_ACTIVITY_CLEAR_TOP</span><span class="p">);</span><span class="w"></span>

<span class="w">         </span><span class="o">//</span><span class="n">Pending</span><span class="w"> </span><span class="n">intent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="n">launch</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Activity</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">intent</span><span class="w"> </span><span class="n">above</span><span class="w"></span>
<span class="w">         </span><span class="n">PendingIntent</span><span class="w"> </span><span class="n">pendingIntent</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">                 </span><span class="n">PendingIntent</span><span class="o">.</span><span class="n">getActivity</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">NotificationHelper</span><span class="o">.</span><span class="n">ALARM_TYPE_RTC</span><span class="p">,</span><span class="w"> </span><span class="n">intentToRepeat</span><span class="p">,</span><span class="w"> </span><span class="n">PendingIntent</span><span class="o">.</span><span class="n">FLAG_UPDATE_CURRENT</span><span class="p">);</span><span class="w"></span>

<span class="w">         </span><span class="o">//</span><span class="n">Build</span><span class="w"> </span><span class="n">notification</span><span class="w"></span>
<span class="w">         </span><span class="n">Notification</span><span class="w"> </span><span class="n">repeatedNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buildLocalNotification</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">pendingIntent</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">();</span><span class="w"></span>

<span class="w">         </span><span class="o">//</span><span class="n">Send</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">notification</span><span class="w"></span>
<span class="w">         </span><span class="n">NotificationHelper</span><span class="o">.</span><span class="n">getNotificationManager</span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="n">NotificationHelper</span><span class="o">.</span><span class="n">ALARM_TYPE_RTC</span><span class="p">,</span><span class="w"> </span><span class="n">repeatedNotification</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span><span class="p">}</span><span class="w"></span>

<span class="w">     </span><span class="n">public</span><span class="w"> </span><span class="n">NotificationCompat</span><span class="o">.</span><span class="n">Builder</span><span class="w"> </span><span class="n">buildLocalNotification</span><span class="p">(</span><span class="n">Context</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">PendingIntent</span><span class="w"> </span><span class="n">pendingIntent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">         </span><span class="n">NotificationCompat</span><span class="o">.</span><span class="n">Builder</span><span class="w"> </span><span class="n">builder</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">                 </span><span class="p">(</span><span class="n">NotificationCompat</span><span class="o">.</span><span class="n">Builder</span><span class="p">)</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">NotificationCompat</span><span class="o">.</span><span class="n">Builder</span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="w"></span>
<span class="w">                 </span><span class="o">.</span><span class="n">setContentIntent</span><span class="p">(</span><span class="n">pendingIntent</span><span class="p">)</span><span class="w"></span>
<span class="w">                 </span><span class="o">.</span><span class="n">setSmallIcon</span><span class="p">(</span><span class="n">android</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">drawable</span><span class="o">.</span><span class="n">arrow_up_float</span><span class="p">)</span><span class="w"></span>
<span class="w">                 </span><span class="o">.</span><span class="n">setContentTitle</span><span class="p">(</span><span class="s2">&quot;Morning Notification&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">                 </span><span class="o">.</span><span class="n">setAutoCancel</span><span class="p">(</span><span class="bp">true</span><span class="p">);</span><span class="w"></span>

<span class="w">         </span><span class="k">return</span><span class="w"> </span><span class="n">builder</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
</code></pre></div>

<p><strong><em>Note:</em></strong> Don't forget to add <code>&lt;receiver&gt;</code> tag in <code>AndroidManifest.xml</code></p>
<div class="highlight"><pre><span></span><code>&lt;receiver android:name=&quot;.notification.AlarmReceiver&quot;/&gt;
</code></pre></div>

<h4>NotificationHelper</h4>
<p><a href="https://github.com/ptyagicodecamp/RepeatingLocalNotifications/blob/master/app/src/main/java/org/pcc/repeatinglocalnotifications/notification/NotificationHelper.java">Convenience helper class</a> to generate notification</p>
<h4>Don't loose your notifications settings across device boots</h4>
<p>Alarms will be cancelled when a device re-boots, so your notification settings.
In order to persist your notifications setting or alarms across device reboots,
you would need to reset alarm when a device boots up.</p>
<h5>AndroidManifest.xml configuration</h5>
<p>Add this permission in <code>AndroidManifest.xml</code></p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.RECEIVE_BOOT_COMPLETED&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;application</span>
<span class="err">...</span><span class="nt">&gt;</span>

    <span class="nt">&lt;receiver</span> <span class="na">android:name=</span><span class="s">&quot;.notification.AlarmBootReceiver&quot;</span>
            <span class="na">android:enabled=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;intent-filter&gt;</span>
            <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.action.BOOT_COMPLETED&quot;</span><span class="nt">&gt;&lt;/action&gt;</span>
        <span class="nt">&lt;/intent-filter&gt;</span>
    <span class="nt">&lt;/receiver&gt;</span>

<span class="nt">&lt;/application&gt;</span>
</code></pre></div>

<h5>Implementing Boot Receiver</h5>
<p><code>AlarmBootReceiver</code> will look like this:</p>
<div class="highlight"><pre><span></span><code><span class="n">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">AlarmBootReceiver</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">BroadcastReceiver</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="err">@</span><span class="n">Override</span><span class="w"></span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">onReceive</span><span class="p">(</span><span class="n">Context</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">Intent</span><span class="w"> </span><span class="n">intent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">intent</span><span class="o">.</span><span class="n">getAction</span><span class="p">()</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="s2">&quot;android.intent.action.BOOT_COMPLETED&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="n">only</span><span class="w"> </span><span class="n">enabling</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">notifications</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">demo</span><span class="w"> </span><span class="n">purposes</span><span class="w"></span>
<span class="w">            </span><span class="n">NotificationHelper</span><span class="o">.</span><span class="n">scheduleRepeatingElapsedNotification</span><span class="p">(</span><span class="n">context</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>Enable boot receiver when Alarm is set. It means if user opts-into notifications, then
enable boot receiver as part of enabling notification code.</p>
<div class="highlight"><pre><span></span><code>ComponentName receiver = new ComponentName(context, AlarmBootReceiver.class);
PackageManager pm = context.getPackageManager();

pm.setComponentEnabledSetting(receiver,
        PackageManager.COMPONENT_ENABLED_STATE_ENABLED,
        PackageManager.DONT_KILL_APP);
</code></pre></div>

<p>When user opts-out from notifications, you can cancel alarm and also disable boot receiver like this:</p>
<div class="highlight"><pre><span></span><code>ComponentName receiver = new ComponentName(context, AlarmBootReceiver.class);
PackageManager pm = context.getPackageManager();

pm.setComponentEnabledSetting(receiver,
        PackageManager.COMPONENT_ENABLED_STATE_DISABLED,
        PackageManager.DONT_KILL_APP);
</code></pre></div>

<p>That's it !</p>
<p><strong><em>References:</em></strong></p>
<ul>
<li>Source Code is available <a href="https://github.com/ptyagicodecamp/RepeatingLocalNotifications">here</a></li>
<li>More details you can find <a href="https://developer.android.com/training/scheduling/alarms.html">here</a></li>
</ul>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://ptyagicodecamp.github.io/tag/android.html">Android</a>
      <a href="https://ptyagicodecamp.github.io/tag/notifications.html">Notifications</a>
      <a href="https://ptyagicodecamp.github.io/tag/alarmmanager.html">AlarmManager</a>
    </p>
  </div>

  <div class="center social-share">
    <p>Like this article? Share it with your friends!</p>
    <div class="addthis_native_toolbox"></div>
    <div class="addthis_sharing_toolbox"></div>
    <div class="addthis_inline_share_toolbox"></div>
  </div>


    <div class="addthis_relatedposts_inline"></div>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle ads-responsive"
         data-ad-client="ca-pub-6359982310050489"
         data-ad-slot="6546879945"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'https-ptyagicodecamp-github-io';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
    Please enable JavaScript to view comments.
</noscript>
<!-- End Disqus -->
</article>

    <footer>
<p>
  &copy; 2022  - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>


    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5cf387135c8761da" async="async"></script>


<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " tech&Life ",
  "url" : "https://ptyagicodecamp.github.io",
  "image": "https://ptyagicodecamp.github.io/images/profile.jpg",
  "description": "Mobile engineering tech logger."
}
</script>
<a href="https://github.com/ptyagicodecamp" class="github-corner" aria-label="View source on Github">
    <svg width="80"
         height="80"
         viewBox="0 0 250 250"
         style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;"
         aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor"
              style="transform-origin: 130px 106px;"
              class="octo-arm">
        </path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor"
              class="octo-body">
        </path>
    </svg>
</a>
<style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

</body>
</html>